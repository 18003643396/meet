UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={};UE.plugins={};UE.commands={};UE.version="1.2.0.0";var dom=UE.dom={};var browser=UE.browser=function(){var a=navigator.userAgent.toLowerCase(),d=window.opera,c={ie:!!window.ActiveXObject,opera:!!d&&d.version,webkit:-1<a.indexOf(" applewebkit/"),mac:-1<a.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode};c.gecko="Gecko"==navigator.product&&!c.webkit&&!c.opera;var h=0;c.ie&&(h=parseFloat(a.match(/msie (\d+)/)[1]),c.ie8=!!document.documentMode,c.ie8Compat=8==document.documentMode,c.ie7Compat=7==h&&!document.documentMode||7==document.documentMode,c.ie6Compat=
7>h||c.quirks);if(c.gecko){var b=a.match(/rv:([\d\.]+)/);b&&(b=b[1].split("."),h=1E4*b[0]+100*(b[1]||0)+1*(b[2]||0))}/chrome\/(\d+\.\d)/i.test(a)&&(c.chrome=+RegExp.$1);/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(a)&&!/chrome/i.test(a)&&(c.safari=+(RegExp.$1||RegExp.$2));c.opera&&(h=parseFloat(d.version()));c.webkit&&(h=parseFloat(a.match(/ applewebkit\/(\d+)/)[1]));c.version=h;c.gecko&&(11<=c.version&&-1<a.indexOf(" .net")&&-1<a.lastIndexOf("like gecko"))&&(c.ie11plus=!0);c.isCompatible=!c.mobile&&
(c.ie&&6<=h||c.gecko&&10801<=h||c.opera&&9.5<=h||c.air&&1<=h||c.webkit&&522<=h||!1);return c}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko;var utils=UE.utils={makeInstance:function(a){var d=new Function;d.prototype=a;a=new d;d.prototype=null;return a},extend:function(a,d,c){if(d)for(var h in d)if(!c||!a.hasOwnProperty(h))a[h]=d[h];return a},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},isString:function(a){return"string"==typeof a||a.constructor==String},inherits:function(a,d){var c=a.prototype,h=utils.makeInstance(d.prototype);utils.extend(h,c,!0);a.prototype=h;return h.constructor=a},bind:function(a,
d){return function(){return a.apply(d,arguments)}},defer:function(a,d,c){var h;return function(){c&&clearTimeout(h);h=setTimeout(a,d)}},indexOf:function(a,d,c){for(var c=c||0,h=a.length;c<h;c++)if(a[c]===d)return c;return-1},findNode:function(a,d,c){for(var h=0,b;b=a[h++];)if(c?c(b):-1!=this.indexOf(d,b.tagName.toLowerCase()))return b},removeItem:function(a,d){for(var c=0,h=a.length;c<h;c++)a[c]===d&&(a.splice(c,1),c--)},trim:function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(a){if(!a)return{};
for(var a=utils.isArray(a)?a:a.split(","),d=0,c,h={};c=a[d++];)h[c.toUpperCase()]=h[c]=1;return h},unhtml:function(a){return a?a.replace(/[&<">]/g,function(a){return{"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"}[a]}):""},cssStyleToDomStyle:function(){var a=document.createElement("div").style,d={"float":void 0!=a.cssFloat?"cssFloat":void 0!=a.styleFloat?"styleFloat":"float"};return function(a){return d[a]||(d[a]=a.toLowerCase().replace(/-./g,function(a){return a.charAt(1).toUpperCase()}))}}(),loadFile:function(a,
d,c){if(!d.id||!a.getElementById(d.id)){var h=a.createElement(d.tag);delete d.tag;for(var b in d)h.setAttribute(b,d[b]);h.onload=h.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState))c&&c(),h.onload=h.onreadystatechange=null};a.getElementsByTagName("head")[0].appendChild(h)}},isEmptyObject:function(a){for(var d in a)return!1;return!0},fixColor:function(a,d){if(/color/i.test(a)&&/rgba?/.test(d)){var c=d.split(",");if(3<c.length)return"";for(var d="#",h=0,b;b=
c[h++];)b=parseInt(b.replace(/[^\d]/gi,""),10).toString(16),d+=1==b.length?"0"+b:b;d=d.toUpperCase()}return d},optCss:function(a){function d(b,e){if(!b)return"";var a=b.top,g=b.bottom,j=b.left,f=b.right,c="";if(!a||!j||!g||!f)for(var h in b)c+=";"+e+"-"+h+":"+b[h]+";";else c+=";"+e+":"+(a==g&&g==j&&j==f?a:a==g&&j==f?a+" "+j:j==f?a+" "+j+" "+g:a+" "+f+" "+g+" "+j)+";";return c}var c,h,a=a.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(b,e,a,g){if(1==g.split(" ").length)switch(e){case "padding":return!c&&
(c={}),c[a]=g,"";case "margin":return!h&&(h={}),h[a]=g,"";case "border":return"initial"==g?"":b}return b}),a=a+(d(c,"padding")+d(h,"margin"));return a.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(b,e){return e?e+";;":";"})}};var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(a,d){getListener(this,a,!0).push(d)},removeListener:function(a,d){var c=getListener(this,a);c&&utils.removeItem(c,d)},fireEvent:function(a){var d=getListener(this,a),c,h,b;if(d)for(b=d.length;b--;)h=d[b].apply(this,arguments),void 0!==h&&(c=h);if(h=this["on"+a.toLowerCase()])c=h.apply(this,arguments);return c}};
function getListener(a,d,c){var h,d=d.toLowerCase();return(h=a.__allListeners||c&&(a.__allListeners={}))&&(h[d]||c&&(h[d]=[]))};var dtd=dom.dtd=function(){function a(b){for(var f in b)b[f.toUpperCase()]=b[f];return b}function d(b){for(var f=arguments,j=1;j<f.length;j++){var e=f[j],g;for(g in e)b.hasOwnProperty(g)||(b[g]=e[g])}return b}var c=a({isindex:1,fieldset:1}),h=a({input:1,button:1,select:1,textarea:1,label:1}),b=d(a({a:1}),h),e=d({iframe:1},b),i=a({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),g=a({ins:1,del:1,script:1,style:1}),
j=d(a({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),g),f=d(a({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),j),m=d(a({p:1}),f),h=d(a({iframe:1}),f,h),f=a({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,
textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),l=d(a({a:0}),h),k=a({tr:1}),n=a({"#":1}),t=d(a({param:1}),f),q=d(a({form:1}),c,e,i,m),o=a({li:1}),s=a({style:1,script:1}),r=a({base:1,link:1,meta:1,title:1}),s=d(r,s),u=a({head:1,body:1}),v=a({html:1}),x=a({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,
form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),y=a({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return a({$nonBodyContent:d(v,u,r),$block:x,$inline:l,$body:d(a({script:1,style:1}),x),$cdata:a({script:1,style:1}),$empty:y,$nonChild:a({iframe:1}),$listItem:a({dd:1,dt:1,li:1}),$list:a({ul:1,ol:1,dl:1}),$isNotEmpty:a({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),
$removeEmpty:a({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:a({p:1,div:1}),$tableContent:a({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:a({pre:1,script:1,style:1,textarea:1}),html:u,head:s,style:n,script:n,body:q,base:{},link:{},meta:{},title:n,col:{},tr:a({td:1,th:1}),img:{},embed:{},colgroup:a({thead:1,
col:1,tbody:1,tr:1,tfoot:1}),noscript:q,td:q,br:{},th:q,center:q,kbd:l,button:d(m,i),basefont:{},h5:l,h4:l,samp:l,h6:l,ol:o,h1:l,h3:l,option:n,h2:l,form:d(c,e,i,m),select:a({optgroup:1,option:1}),font:l,ins:l,menu:o,abbr:l,label:l,table:a({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:l,tfoot:k,cite:l,li:q,input:{},iframe:q,strong:l,textarea:n,noframes:q,big:l,small:l,span:a({"#":1,br:1}),hr:l,dt:l,sub:l,optgroup:a({option:1}),param:{},bdo:l,"var":l,div:q,object:t,sup:l,dd:q,strike:l,
area:{},dir:o,map:d(a({area:1,form:1,p:1}),c,g,i),applet:t,dl:a({dt:1,dd:1}),del:l,isindex:{},fieldset:d(a({legend:1}),f),thead:k,ul:o,acronym:l,b:l,a:d(a({a:1}),h),blockquote:d(a({td:1,tr:1,tbody:1,li:1}),q),caption:l,i:l,u:l,tbody:k,s:l,address:d(e,m),tt:l,legend:l,q:l,pre:d(j,b),p:d(a({a:1}),l),em:l,dfn:l})}();function getDomNode(a,d,c,h,b,e){var h=h&&a[d],i;for(!h&&(h=a[c]);!h&&(i=(i||a).parentNode);){if("BODY"==i.tagName||e&&!e(i))return null;h=i[c]}return h&&b&&!b(h)?getDomNode(h,d,c,!1,b):h}
var attrFix=ie&&9>browser.version?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap("-webkit-box -moz-box block list-item table table-row-group table-header-group table-footer-group table-row table-column-group table-column table-cell table-caption".split(" ")),
domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&"6"==browser.version?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(a,d){if(a===d)return 0;var c,h=[a],b=[d];for(c=a;c=c.parentNode;){if(c===d)return 10;h.push(c)}for(c=d;c=c.parentNode;){if(c===a)return 20;
b.push(c)}h.reverse();b.reverse();if(h[0]!==b[0])return 1;for(c=-1;c++,h[c]===b[c];);a=h[c];for(d=b[c];a=a.nextSibling;)if(a===d)return 4;return 2},getNodeIndex:function(a){for(var d=a.parentNode.firstChild,c=0;a!==d;)c++,d=d.nextSibling;return c},inDoc:function(a,d){for(;a=a.parentNode;)if(a===d)return!0;return!1},findParent:function(a,d,c){if(!domUtils.isBody(a))for(a=c?a:a.parentNode;a;){if(!d||d(a)||this.isBody(a))return d&&!d(a)&&this.isBody(a)?null:a;a=a.parentNode}return null},findParentByTagName:function(a,
d,c,h){if(a&&a.nodeType&&!this.isBody(a)&&(1==a.nodeType||a.nodeType)){d=utils.listToMap(utils.isArray(d)?d:[d]);for(a=3==a.nodeType||!c?a.parentNode:a;a&&(a.tagName&&9!=a.nodeType)&&(!h||!h(a));){if(d[a.tagName])return a;a=a.parentNode}}return null},findParents:function(a,d,c,h){for(d=d&&(c&&c(a)||!c)?[a]:[];a=domUtils.findParent(a,c);)d.push(a);return h?d:d.reverse()},insertAfter:function(a,d){return a.parentNode.insertBefore(d,a.nextSibling)},remove:function(a,d){var c=a.parentNode,h;if(c){if(d&&
a.hasChildNodes())for(;h=a.firstChild;)c.insertBefore(h,a);c.removeChild(a)}return a},getNextDomNode:function(a,d,c,h){return getDomNode(a,"firstChild","nextSibling",d,c,h)},isBookmarkNode:function(a){return 1==a.nodeType&&a.id&&/^_baidu_bookmark_/i.test(a.id)},getWindow:function(a){a=a.ownerDocument||a;return a.defaultView||a.parentWindow},getCommonAncestor:function(a,d){if(a===d)return a;for(var c=[a],h=[d],b=a,e=-1;b=b.parentNode;){if(b===d)return b;c.push(b)}for(b=d;b=b.parentNode;){if(b===a)return b;
h.push(b)}c.reverse();for(h.reverse();e++,c[e]===h[e];);return 0==e?null:c[e-1]},clearEmptySibling:function(a,d,c){function h(b,e){for(var a;b&&!domUtils.isBookmarkNode(b)&&(domUtils.isEmptyInlineElement(b)||domUtils.isWhitespace(b));)a=b[e],domUtils.remove(b),b=a}!d&&h(a.nextSibling,"nextSibling");!c&&h(a.previousSibling,"previousSibling")},split:function(a,d){var c=a.ownerDocument;if(browser.ie&&d==a.nodeValue.length){var h=c.createTextNode("");return domUtils.insertAfter(a,h)}h=a.splitText(d);
browser.ie8&&(c=c.createTextNode(""),domUtils.insertAfter(h,c),domUtils.remove(c));return h},isWhitespace:function(a){return!RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(a.nodeValue)},getXY:function(a){for(var d=0,c=0;a.offsetParent;)c+=a.offsetTop,d+=a.offsetLeft,a=a.offsetParent;return{x:d,y:c}},on:function(a,d,c){var h=d instanceof Array?d:[d],b=h.length;if(b)for(;b--;)if(d=h[b],a.addEventListener)a.addEventListener(d,c,!1);else{c._d||(c._d={});var e=d+c.toString();c._d[e]||(c._d[e]=function(b){return c.call(b.srcElement,
b||window.event)},a.attachEvent("on"+d,c._d[e]))}a=null},un:function(a,d,c){var h=d instanceof Array?d:[d],b=h.length;if(b)for(;b--;)if(d=h[b],a.removeEventListener)a.removeEventListener(d,c,!1);else{var e=d+c.toString();a.detachEvent("on"+d,c._d?c._d[e]:c);c._d&&c._d[e]&&delete c._d[e]}},isSameElement:function(a,d){if(a.tagName!=d.tagName)return 0;var c=a.attributes,h=d.attributes;if(!ie&&c.length!=h.length)return 0;for(var b,e,i=0,g=0,j=0;b=c[j++];){if("style"==b.nodeName)if(b.specified&&i++,domUtils.isSameStyle(a,
d))continue;else return 0;if(ie)if(b.specified)i++,e=h.getNamedItem(b.nodeName);else continue;else e=d.attributes[b.nodeName];if(!e.specified||b.nodeValue!=e.nodeValue)return 0}if(ie){for(j=0;e=h[j++];)e.specified&&g++;if(i!=g)return 0}return 1},isSameStyle:function(a,d){var c=a.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),h=d.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(!c||!h)return c==h?1:0;c=c.split(";");h=h.split(";");if(c.length!=h.length)return 0;for(var b=
0,e;e=c[b++];)if(-1==utils.indexOf(h,e))return 0;return 1},isBlockElm:function(a){return 1==a.nodeType&&(dtd.$block[a.tagName]||styleBlock[domUtils.getComputedStyle(a,"display")])&&!dtd.$nonChild[a.tagName]},isBody:function(a){return a&&1==a.nodeType&&"body"==a.tagName.toLowerCase()},breakParent:function(a,d){var c,h=a,b=a,e,i;do{h=h.parentNode;e?(c=h.cloneNode(!1),c.appendChild(e),e=c,c=h.cloneNode(!1),c.appendChild(i),i=c):(e=h.cloneNode(!1),i=e.cloneNode(!1));for(;c=b.previousSibling;)e.insertBefore(c,
e.firstChild);for(;c=b.nextSibling;)i.appendChild(c);b=h}while(d!==h);c=d.parentNode;c.insertBefore(e,d);c.insertBefore(i,d);c.insertBefore(a,i);domUtils.remove(d);return a},isEmptyInlineElement:function(a){if(1!=a.nodeType||!dtd.$removeEmpty[a.tagName])return 0;for(a=a.firstChild;a;){if(domUtils.isBookmarkNode(a)||1==a.nodeType&&!domUtils.isEmptyInlineElement(a)||3==a.nodeType&&!domUtils.isWhitespace(a))return 0;a=a.nextSibling}return 1},trimWhiteTextNode:function(a){function d(c){for(var h;(h=a[c])&&
3==h.nodeType&&domUtils.isWhitespace(h);)a.removeChild(h)}d("firstChild");d("lastChild")},mergChild:function(a,d,c){for(var h=domUtils.getElementsByTagName(a,a.tagName.toLowerCase()),b=0,e;e=h[b++];)if(e.parentNode&&!domUtils.isBookmarkNode(e))if("span"==e.tagName.toLowerCase()){if(a===e.parentNode&&(domUtils.trimWhiteTextNode(a),1==a.childNodes.length)){a.style.cssText=e.style.cssText+";"+a.style.cssText;domUtils.remove(e,!0);continue}e.style.cssText=a.style.cssText+";"+e.style.cssText;if(c){var i=
c.style;if(i)for(var i=i.split(";"),g=0,j;j=i[g++];)e.style[utils.cssStyleToDomStyle(j.split(":")[0])]=j.split(":")[1]}domUtils.isSameStyle(e,a)&&domUtils.remove(e,!0)}else domUtils.isSameElement(a,e)&&domUtils.remove(e,!0);if("span"==d){d=domUtils.getElementsByTagName(a,"a");for(b=0;c=d[b++];)c.style.cssText=";"+a.style.cssText,c.style.textDecoration="underline"}},getElementsByTagName:function(a,d){for(var c=a.getElementsByTagName(d),h=[],b=0,e;e=c[b++];)h.push(e);return h},mergToParent:function(a){for(var d=
a.parentNode;d&&dtd.$removeEmpty[d.tagName];){if(d.tagName==a.tagName||"A"==d.tagName){domUtils.trimWhiteTextNode(d);if("SPAN"==d.tagName&&!domUtils.isSameStyle(d,a)||"A"==d.tagName&&"SPAN"==a.tagName)if(1<d.childNodes.length||d!==a.parentNode){a.style.cssText=d.style.cssText+";"+a.style.cssText;d=d.parentNode;continue}else d.style.cssText+=";"+a.style.cssText,"A"==d.tagName&&(d.style.textDecoration="underline");if("A"!=d.tagName){d===a.parentNode&&domUtils.remove(a,!0);break}}d=d.parentNode}},mergSibling:function(a,
d,c){function h(b,e,a){var g;if((g=a[b])&&!domUtils.isBookmarkNode(g)&&1==g.nodeType&&domUtils.isSameElement(a,g)){for(;g.firstChild;)"firstChild"==e?a.insertBefore(g.lastChild,a.firstChild):a.appendChild(g.firstChild);domUtils.remove(g)}}!d&&h("previousSibling","firstChild",a);!c&&h("nextSibling","lastChild",a)},unselectable:gecko?function(a){a.style.MozUserSelect="none"}:webkit?function(a){a.style.KhtmlUserSelect="none"}:function(a){a.onselectstart=function(){return!1};a.onclick=a.onkeyup=a.onkeydown=
function(){return!1};a.unselectable="on";a.setAttribute("unselectable","on");for(var d=0,c;c=a.all[d++];)switch(c.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:c.unselectable="on",a.setAttribute("unselectable","on")}},removeAttributes:function(a,d){for(var c=0,h;h=d[c++];){h=attrFix[h]||h;switch(h){case "className":a[h]="";break;case "style":a.style.cssText="",!browser.ie&&a.getAttributeNode("style")&&a.removeAttributeNode(a.getAttributeNode("style"))}a.removeAttribute(h)}},
setAttributes:function(a,d){for(var c in d){var h=d[c];switch(c){case "class":a.className=h;break;case "style":a.style.cssText=a.style.cssText+";"+h;break;case "innerHTML":a[c]=h;break;case "value":a.value=h;break;default:a.setAttribute(attrFix[c]||c,h)}}return a},getComputedStyle:function(a,d){3==a.nodeType&&(a=a.parentNode);if(browser.ie&&9>browser.version&&"font-size"==d&&!a.style.fontSize&&!dtd.$empty[a.tagName]&&!dtd.$nonChild[a.tagName]){var c=a.ownerDocument.createElement("span");c.style.cssText=
"padding:0;border:0;font-family:simsun;";c.innerHTML=".";a.appendChild(c);var h=c.offsetHeight;a.removeChild(c);return h+"px"}try{c=domUtils.getStyle(a,d)||(window.getComputedStyle?domUtils.getWindow(a).getComputedStyle(a,"").getPropertyValue(d):(a.currentStyle||a.style)[utils.cssStyleToDomStyle(d)])}catch(b){return null}c=utils.fixColor(d,c);"font-size"==d&&/pt$/.test(c)&&(c=Math.round(parseFloat(c)/0.75)+"px");return c},removeClasses:function(a,d){a.className=(" "+a.className+" ").replace(RegExp("(?:\\s+(?:"+
d.join("|")+"))+\\s+","g")," ")},addClassName:function(a,d){this.hasClass(a,d)||(a.className=a.className+" "+d)},delClassName:function(a,d){this.hasClass(a,d)&&(a.className=a.className.replace(RegExp("(^"+d+"\\s+)|(\\s+"+d+"\\s+)|(\\s+"+d+"$)","g")," "))},removeStyle:function(a,d){a.style[utils.cssStyleToDomStyle(d)]="";a.style.cssText||domUtils.removeAttributes(a,["style"])},hasClass:function(a,d){return-1<(" "+a.className+" ").indexOf(" "+d+" ")},preventDefault:function(a){a.preventDefault?a.preventDefault():
a.returnValue=!1},getStyle:function(a,d){var c=a.style[utils.cssStyleToDomStyle(d)];return utils.fixColor(d,c)},setStyle:function(a,d,c){a.style[utils.cssStyleToDomStyle(d)]=c},setStyles:function(a,d){for(var c in d)d.hasOwnProperty(c)&&domUtils.setStyle(a,c,d[c])},removeDirtyAttr:function(a){for(var d=0,c,h=a.getElementsByTagName("*");c=h[d++];)c.removeAttribute("_moz_dirty");a.removeAttribute("_moz_dirty")},getChildCount:function(a,d){for(var c=0,h=a.firstChild,d=d||function(){return 1};h;)d(h)&&
c++,h=h.nextSibling;return c},isEmptyNode:function(a){return!a.firstChild||0==domUtils.getChildCount(a,function(a){return!domUtils.isBr(a)&&!domUtils.isBookmarkNode(a)&&!domUtils.isWhitespace(a)})},clearSelectedArr:function(a){for(var d;d=a.pop();)domUtils.removeAttributes(d,["class"])},scrollToView:function(a,d,c){var h=function(){var b=d.document,e="CSS1Compat"==b.compatMode;return{width:(e?b.documentElement.clientWidth:b.body.clientWidth)||0,height:(e?b.documentElement.clientHeight:b.body.clientHeight)||
0}}().height,c=-1*h+c+(a.offsetHeight||0),a=domUtils.getXY(a),c=c+a.y,a=function(b){if("pageXOffset"in b)return{x:b.pageXOffset||0,y:b.pageYOffset||0};b=b.document;return{x:b.documentElement.scrollLeft||b.body.scrollLeft||0,y:b.documentElement.scrollTop||b.body.scrollTop||0}}(d).y;if(c>a||c<a-h)d.scrollTo(0,c+(0>c?-20:20))},isBr:function(a){return 1==a.nodeType&&"BR"==a.tagName},isFillChar:function(a){return 3==a.nodeType&&!a.nodeValue.replace(RegExp(domUtils.fillChar),"").length},isStartInblock:function(a){for(var a=
a.cloneRange(),d=0,c=a.startContainer,h;c&&domUtils.isFillChar(c);)h=c,c=c.previousSibling;h&&(a.setStartBefore(h),c=a.startContainer);for(1==c.nodeType&&(domUtils.isEmptyNode(c)&&1==a.startOffset)&&a.setStart(c,0).collapse(!0);!a.startOffset;){c=a.startContainer;if(domUtils.isBlockElm(c)||domUtils.isBody(c)){d=1;break}h=a.startContainer.previousSibling;var b;if(h){for(;h&&domUtils.isFillChar(h);)b=h,h=h.previousSibling;b?a.setStartBefore(b):a.setStartBefore(a.startContainer)}else a.setStartBefore(a.startContainer)}return d&&
!domUtils.isBody(a.startContainer)?1:0},isEmptyBlock:function(a){if(0<a[browser.ie?"innerText":"textContent"].replace(RegExp("[ \t\r\n"+domUtils.fillChar+"]","g"),"").length)return 0;for(var d in dtd.$isNotEmpty)if(a.getElementsByTagName(d).length)return 0;return 1},setViewportOffset:function(a,d){var c=parseInt(a.style.left)|0,h=parseInt(a.style.top)|0,b=a.getBoundingClientRect(),e=d.left-b.left,b=d.top-b.top;e&&(a.style.left=c+e+"px");b&&(a.style.top=h+b+"px")},fillNode:function(a,d){var c=browser.ie?
a.createTextNode(domUtils.fillChar):a.createElement("br");d.innerHTML="";d.appendChild(c)},moveChild:function(a,d,c){for(;a.firstChild;)c&&d.firstChild?d.insertBefore(a.lastChild,d.firstChild):d.appendChild(a.firstChild)},hasNoAttributes:function(a){return browser.ie?/^<\w+\s*?>/.test(a.outerHTML):0==a.attributes.length}},fillCharReg=RegExp(domUtils.fillChar,"g");(function(){function a(b,f,e,a){if(1==f.nodeType&&(dtd.$empty[f.tagName]||dtd.$nonChild[f.tagName]))e=domUtils.getNodeIndex(f)+(b?0:1),f=f.parentNode;b?(a.startContainer=f,a.startOffset=e,a.endContainer||a.collapse(!0)):(a.endContainer=f,a.endOffset=e,a.startContainer||a.collapse(!1));a.collapsed=a.startContainer&&a.endContainer&&a.startContainer===a.endContainer&&a.startOffset==a.endOffset;return a}function d(b,f){var a=b.startContainer,e=b.endContainer,g=b.startOffset,i=b.endOffset,c=b.document,
h=c.createDocumentFragment(),d,s;1==a.nodeType&&(a=a.childNodes[g]||(d=a.appendChild(c.createTextNode(""))));1==e.nodeType&&(e=e.childNodes[i]||(s=e.appendChild(c.createTextNode(""))));if(a===e&&3==a.nodeType)return h.appendChild(c.createTextNode(a.substringData(g,i-g))),f&&(a.deleteData(g,i-g),b.collapse(!0)),h;for(var r,u,v=h,x=domUtils.findParents(a,!0),y=domUtils.findParents(e,!0),w=0;x[w]==y[w];w++);for(var z=w,A;A=x[z];z++){r=A.nextSibling;A==a?d||(3==b.startContainer.nodeType?(v.appendChild(c.createTextNode(a.nodeValue.slice(g))),
f&&a.deleteData(g,a.nodeValue.length-g)):v.appendChild(!f?a.cloneNode(!0):a)):(u=A.cloneNode(!1),v.appendChild(u));for(;r&&!(r===e||r===y[z]);)A=r.nextSibling,v.appendChild(!f?r.cloneNode(!0):r),r=A;v=u}v=h;x[w]||(v.appendChild(x[w-1].cloneNode(!1)),v=v.firstChild);for(z=w;g=y[z];z++){r=g.previousSibling;g==e?!s&&3==b.endContainer.nodeType&&(v.appendChild(c.createTextNode(e.substringData(0,i))),f&&e.deleteData(0,i)):(u=g.cloneNode(!1),v.appendChild(u));if(z!=w||!x[w])for(;r&&r!==a;)g=r.previousSibling,
v.insertBefore(!f?r.cloneNode(!0):r,v.firstChild),r=g;v=u}f&&b.setStartBefore(!y[w]?y[w-1]:!x[w]?x[w-1]:y[w]).collapse(!0);d&&domUtils.remove(d);s&&domUtils.remove(s);return h}function c(b,f){try{if(i&&domUtils.inDoc(i,b))if(i.nodeValue.replace(fillCharReg,"").length)i.nodeValue=i.nodeValue.replace(fillCharReg,"");else{var a=i.parentNode;for(domUtils.remove(i);a&&domUtils.isEmptyInlineElement(a)&&!a.contains(f);)i=a.parentNode,domUtils.remove(a),a=i}}catch(e){}}function h(b,f){for(var a,b=b[f];b&&
domUtils.isFillChar(b);)a=b[f],domUtils.remove(b),b=a}var b=0,e=domUtils.fillChar,i,g=dom.Range=function(b){this.startContainer=this.startOffset=this.endContainer=this.endOffset=null;this.document=b;this.collapsed=!0};g.prototype={cloneContents:function(){return this.collapsed?null:d(this,0)},deleteContents:function(){this.collapsed||d(this,1);if(browser.webkit){var b=this.startContainer;3==b.nodeType&&!b.nodeValue.length&&(this.setStartBefore(b).collapse(!0),domUtils.remove(b))}return this},extractContents:function(){return this.collapsed?
null:d(this,2)},setStart:function(b,f){return a(!0,b,f,this)},setEnd:function(b,f){return a(!1,b,f,this)},setStartAfter:function(b){return this.setStart(b.parentNode,domUtils.getNodeIndex(b)+1)},setStartBefore:function(b){return this.setStart(b.parentNode,domUtils.getNodeIndex(b))},setEndAfter:function(b){return this.setEnd(b.parentNode,domUtils.getNodeIndex(b)+1)},setEndBefore:function(b){return this.setEnd(b.parentNode,domUtils.getNodeIndex(b))},selectNode:function(b){return this.setStartBefore(b).setEndAfter(b)},
selectNodeContents:function(b){return this.setStart(b,0).setEnd(b,3==b.nodeType?b.nodeValue.length:b.childNodes.length)},cloneRange:function(){return(new g(this.document)).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)},collapse:function(b){b?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset);this.collapsed=!0;return this},shrinkBoundary:function(b){for(var f,a=this.collapsed;1==
this.startContainer.nodeType&&(f=this.startContainer.childNodes[this.startOffset])&&1==f.nodeType&&!domUtils.isBookmarkNode(f)&&!dtd.$empty[f.tagName]&&!dtd.$nonChild[f.tagName];)this.setStart(f,0);if(a)return this.collapse(!0);if(!b)for(;1==this.endContainer.nodeType&&0<this.endOffset&&(f=this.endContainer.childNodes[this.endOffset-1])&&1==f.nodeType&&!domUtils.isBookmarkNode(f)&&!dtd.$empty[f.tagName]&&!dtd.$nonChild[f.tagName];)this.setEnd(f,f.childNodes.length);return this},getCommonAncestor:function(b,
f){var a=this.startContainer,e=this.endContainer;return a===e?b&&1==a.nodeType&&this.startOffset==this.endOffset-1?a.childNodes[this.startOffset]:f&&3==a.nodeType?a.parentNode:a:domUtils.getCommonAncestor(a,e)},trimBoundary:function(b){this.txtToElmBoundary();var f=this.startContainer,a=this.startOffset,e=this.collapsed,g=this.endContainer;if(3==f.nodeType){if(0==a)this.setStartBefore(f);else if(a>=f.nodeValue.length)this.setStartAfter(f);else{var i=domUtils.split(f,a);f===g?this.setEnd(i,this.endOffset-
a):f.parentNode===g&&(this.endOffset+=1);this.setStartBefore(i)}if(e)return this.collapse(!0)}b||(a=this.endOffset,g=this.endContainer,3==g.nodeType&&(0==a?this.setEndBefore(g):(a>=g.nodeValue.length||domUtils.split(g,a),this.setEndAfter(g))));return this},txtToElmBoundary:function(){function b(f,a){var g=f[a+"Container"],e=f[a+"Offset"];if(3==g.nodeType)if(e){if(e>=g.nodeValue.length)f["set"+a.replace(/(\w)/,function(b){return b.toUpperCase()})+"After"](g)}else f["set"+a.replace(/(\w)/,function(b){return b.toUpperCase()})+
"Before"](g)}this.collapsed||(b(this,"start"),b(this,"end"));return this},insertNode:function(b){var f=b,a=1;11==b.nodeType&&(f=b.firstChild,a=b.childNodes.length);this.trimBoundary(!0);var g=this.startContainer,e=g.childNodes[this.startOffset];e?g.insertBefore(b,e):g.appendChild(b);f.parentNode===this.endContainer&&(this.endOffset+=a);return this.setStartBefore(f)},setCursor:function(b,f){return this.collapse(b?!1:!0).select(f)},createBookmark:function(a,f){var g,e=this.document.createElement("span");
e.style.cssText="display:none;line-height:0px;";e.appendChild(this.document.createTextNode("\ufeff"));e.id="_baidu_bookmark_start_"+(f?"":b++);this.collapsed||(g=e.cloneNode(!0),g.id="_baidu_bookmark_end_"+(f?"":b++));this.insertNode(e);g&&(this.collapse(!1).insertNode(g),this.setEndBefore(g));this.setStartAfter(e);return{start:a?e.id:e,end:g?a?g.id:g:null,id:a}},moveToBookmark:function(b){var f=b.id?this.document.getElementById(b.start):b.start,b=b.end&&b.id?this.document.getElementById(b.end):b.end;
this.setStartBefore(f);domUtils.remove(f);b?(this.setEndBefore(b),domUtils.remove(b)):this.collapse(!0);return this},enlarge:function(b,f){var a=domUtils.isBody,g,e,i=this.document.createTextNode("");if(b){e=this.startContainer;1==e.nodeType?e.childNodes[this.startOffset]?g=e=e.childNodes[this.startOffset]:(e.appendChild(i),g=e=i):g=e;for(;;){if(domUtils.isBlockElm(e)){for(e=g;(g=e.previousSibling)&&!domUtils.isBlockElm(g);)e=g;this.setStartBefore(e);break}g=e;e=e.parentNode}e=this.endContainer;1==
e.nodeType?((g=e.childNodes[this.endOffset])?e.insertBefore(i,g):e.appendChild(i),g=e=i):g=e;for(;;){if(domUtils.isBlockElm(e)){for(e=g;(g=e.nextSibling)&&!domUtils.isBlockElm(g);)e=g;this.setEndAfter(e);break}g=e;e=e.parentNode}i.parentNode===this.endContainer&&this.endOffset--;domUtils.remove(i)}if(!this.collapsed){for(;0==this.startOffset&&(!f||!f(this.startContainer))&&!a(this.startContainer);)this.setStartBefore(this.startContainer);for(;this.endOffset==(1==this.endContainer.nodeType?this.endContainer.childNodes.length:
this.endContainer.nodeValue.length)&&(!f||!f(this.endContainer))&&!a(this.endContainer);)this.setEndAfter(this.endContainer)}return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(b,
f,a){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(b){return b.nodeType==1&&domUtils.isBlockElm(b)}).adjustmentBoundary();for(var e=this.createBookmark(),g=e.end,i=function(b){return 1==b.nodeType?"br"!=b.tagName.toLowerCase():!domUtils.isWhitespace(b)},c=domUtils.getNextDomNode(e.start,!1,i),h,d,s=this.cloneRange();c&&domUtils.getPosition(c,g)&domUtils.POSITION_PRECEDING;)if(3==c.nodeType||dtd[b][c.tagName]){s.setStartBefore(c);for(h=c;h&&(3==h.nodeType||dtd[b][h.tagName])&&
h!==g;)d=h,h=domUtils.getNextDomNode(h,1==h.nodeType,null,function(f){return dtd[b][f.tagName]});var c=s.setEndAfter(d).extractContents(),r;if(a&&0<a.length){var u;u=r=a[0].cloneNode(!1);for(var v=1,x;x=a[v++];)r.appendChild(x.cloneNode(!1)),r=r.firstChild}else r=s.document.createElement(b);f&&domUtils.setAttributes(r,f);r.appendChild(c);s.insertNode(a?u:r);var y;"span"==b&&f.style&&/text\-decoration/.test(f.style)&&(y=domUtils.findParentByTagName(r,"a",!0))?(domUtils.setAttributes(y,f),domUtils.remove(r,
!0),r=y):(domUtils.mergSibling(r),domUtils.clearEmptySibling(r));domUtils.mergChild(r,b,f);c=domUtils.getNextDomNode(r,!1,i);domUtils.mergToParent(r);if(h===g)break}else c=domUtils.getNextDomNode(c,!0,i);return this.moveToBookmark(e)},removeInlineStyle:function(b){if(this.collapsed)return this;b=utils.isArray(b)?b:[b];this.shrinkBoundary().adjustmentBoundary();for(var f=this.startContainer,a=this.endContainer;;){if(1==f.nodeType){if(-1<utils.indexOf(b,f.tagName.toLowerCase()))break;if("body"==f.tagName.toLowerCase()){f=
null;break}}f=f.parentNode}for(;;){if(1==a.nodeType){if(-1<utils.indexOf(b,a.tagName.toLowerCase()))break;if("body"==a.tagName.toLowerCase()){a=null;break}}a=a.parentNode}var e=this.createBookmark(),g,i;f&&(i=this.cloneRange().setEndBefore(e.start).setStartBefore(f),g=i.extractContents(),i.insertNode(g),domUtils.clearEmptySibling(f,!0),f.parentNode.insertBefore(e.start,f));a&&(i=this.cloneRange().setStartAfter(e.end).setEndAfter(a),g=i.extractContents(),i.insertNode(g),domUtils.clearEmptySibling(a,
!1,!0),a.parentNode.insertBefore(e.end,a.nextSibling));for(f=domUtils.getNextDomNode(e.start,!1,function(b){return b.nodeType==1});f&&f!==e.end;)a=domUtils.getNextDomNode(f,!0,function(b){return b.nodeType==1}),-1<utils.indexOf(b,f.tagName.toLowerCase())&&domUtils.remove(f,!0),f=a;return this.moveToBookmark(e)},getClosedNode:function(){var b;if(!this.collapsed){var f=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(1==f.startContainer.nodeType&&f.startContainer===f.endContainer&&1==f.endOffset-
f.startOffset&&(f=f.startContainer.childNodes[f.startOffset])&&1==f.nodeType&&(dtd.$empty[f.tagName]||dtd.$nonChild[f.tagName]))b=f}return b},select:browser.ie?function(b,f){var a;this.collapsed||this.shrinkBoundary();var g=this.getClosedNode();if(g&&!f){try{a=this.document.body.createControlRange(),a.addElement(g),a.select()}catch(d){}return this}var g=this.createBookmark(),n=g.start;a=this.document.body.createTextRange();a.moveToElementText(n);a.moveStart("character",1);if(this.collapsed){if(!b&&
3!=this.startContainer.nodeType){var t=this.document.createTextNode(e),q=this.document.createElement("span");q.appendChild(this.document.createTextNode(e));n.parentNode.insertBefore(q,n);n.parentNode.insertBefore(t,n);c(this.document,t);i=t;h(q,"previousSibling");h(n,"nextSibling");a.moveStart("character",-1);a.collapse(!0)}}else t=this.document.body.createTextRange(),n=g.end,t.moveToElementText(n),a.setEndPoint("EndToEnd",t);this.moveToBookmark(g);q&&domUtils.remove(q);a.select();return this}:function(b){var a=
domUtils.getWindow(this.document),g=a.getSelection();browser.gecko?this.document.body.focus():a.focus();g&&(g.removeAllRanges(),this.collapsed&&!b&&(b=this.document.createTextNode(e),this.insertNode(b),c(this.document,b),h(b,"previousSibling"),h(b,"nextSibling"),i=b,this.setStart(b,browser.webkit?1:0).collapse(!0)),b=this.document.createRange(),b.setStart(this.startContainer,this.startOffset),b.setEnd(this.endContainer,this.endOffset),g.addRange(b));return this},scrollToView:function(b,a){var b=b?
window:domUtils.getWindow(this.document),e=this.document.createElement("span");e.innerHTML="&nbsp;";this.cloneRange().insertNode(e);domUtils.scrollToView(e,b,a);domUtils.remove(e);return this}}})();(function(){function a(a,b){var e=domUtils.getNodeIndex,a=a.duplicate();a.collapse(b);var i=a.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var g=i.children,c,f=a.duplicate(),d=0,l=g.length-1,k=-1;d<=l;){k=Math.floor((d+l)/2);c=g[k];f.moveToElementText(c);var n=f.compareEndPoints("StartToStart",a);if(0<n)l=k-1;else if(0>n)d=k+1;else return{container:i,offset:e(c)}}if(-1==k){f.moveToElementText(i);f.setEndPoint("StartToStart",a);f=f.text.replace(/(\r\n|\r)/g,"\n").length;g=
i.childNodes;if(!f)return c=g[g.length-1],{container:c,offset:c.nodeValue.length};for(e=g.length;0<f;)f-=g[--e].nodeValue.length;return{container:g[e],offset:-f}}f.collapse(0<n);f.setEndPoint(0<n?"StartToStart":"EndToStart",a);f=f.text.replace(/(\r\n|\r)/g,"\n").length;if(!f)return dtd.$empty[c.tagName]||dtd.$nonChild[c.tagName]?{container:i,offset:e(c)+(0<n?0:1)}:{container:c,offset:0<n?0:c.childNodes.length};for(;0<f;)try{g=c,c=c[0<n?"previousSibling":"nextSibling"],f-=c.nodeValue.length}catch(t){return{container:i,
offset:e(g)}}return{container:c,offset:0<n?-f:c.nodeValue.length+f}}function d(c,b){if(c.item)b.selectNode(c.item(0));else{var e=a(c,!0);b.setStart(e.container,e.offset);0!=c.compareEndPoints("StartToEnd",c)&&(e=a(c,!1),b.setEnd(e.container,e.offset))}return b}function c(a){var b;try{b=a.getNative().createRange()}catch(e){return null}var c=b.item?b.item(0):b.parentElement();return(c.ownerDocument||c)===a.document?b:null}(dom.Selection=function(a){var b=this;b.document=a;ie&&(a=domUtils.getWindow(a).frameElement,
domUtils.on(a,"beforedeactivate",function(){b._bakIERange=b.getIERange()}),domUtils.on(a,"activate",function(){try{!c(b)&&b._bakIERange&&b._bakIERange.select()}catch(a){}b._bakIERange=null}));a=a=null}).prototype={getNative:function(){var a=this.document;return!a?null:ie?a.selection:domUtils.getWindow(a).getSelection()},getIERange:function(){var a=c(this);return!a&&this._bakIERange?this._bakIERange:a},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();
this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var a=this.getStart();return a?domUtils.findParents(a,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return browser.ie&&c(this)||!browser.ie&&this.getNative().rangeCount?!0:!1},getRange:function(){function a(e){for(var f=b.document.body.firstChild,g=e.collapsed;f&&
f.firstChild;)e.setStart(f,0),f=f.firstChild;e.startContainer||e.setStart(b.document.body,0);g&&e.collapse(!0)}var b=this;if(null!=b._cachedRange)return this._cachedRange;var e=new baidu.editor.dom.Range(b.document);if(ie){var c=b.getIERange();c?d(c,e):a(e)}else{var g=b.getNative();if(g&&g.rangeCount)c=g.getRangeAt(0),g=g.getRangeAt(g.rangeCount-1),e.setStart(c.startContainer,c.startOffset).setEnd(g.endContainer,g.endOffset),e.collapsed&&(domUtils.isBody(e.startContainer)&&!e.startOffset)&&a(e);else{if(this._bakRange&&
domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;a(e)}}return this._bakRange=e},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var a=ie?this.getIERange():this.getRange(),b,e;if(ie){if(!a)return this.document.body.firstChild;if(a.item)return a.item(0);b=a.duplicate();0<b.text.length&&b.moveStart("character",1);b.collapse(1);b=b.parentElement();for(e=a=a.parentElement();a=a.parentNode;)if(a==b){b=e;break}}else if(a.shrinkBoundary(),b=
a.startContainer,1==b.nodeType&&b.hasChildNodes()&&(b=b.childNodes[Math.min(b.childNodes.length-1,a.startOffset)]),3==b.nodeType)return b.parentNode;return b},getText:function(){if(this.isFocus()){var a=this.getNative(),a=browser.ie?a.createRange():a.getRangeAt(0);return a.text||a.toString()}return""}}})();(function(){function a(b){for(var a=b.getElementsByTagName("img"),c,g=0,j;j=a[g++];)if(c=j.getAttribute("orgSrc"))j.src=c,j.removeAttribute("orgSrc");b=b.getElementsByTagName("a");for(g=0;a=b[g++];g++)a.getAttribute("data_ue_src")&&a.setAttribute("href",a.getAttribute("data_ue_src"))}var d=0,c,h=UE.Editor=function(b){this.uid=d++;EventBase.call(this);this.commands={};this.options=utils.extend(b||{},UEDITOR_CONFIG,!0);for(var a in UE.plugins)UE.plugins[a].call(this)};h.prototype={destroy:function(){this.fireEvent("destroy");
this.container.innerHTML="";domUtils.remove(this.container)},render:function(b){b.constructor===String&&(b=document.getElementById(b));b&&(b.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%"  frameborder="0"></iframe>',b.style.overflow="hidden",this._setup(b.firstChild.contentWindow.document));var a=this;if(a.options&&a.options.isAppConfig)try{var c=document.getElementById("edui_fixedlayer");c&&(c.style.display="none");domUtils.hasClass(a.iframe.parentNode.previousSibling,
"edui-editor-toolbarbox")&&(a.iframe.parentNode.previousSibling.style.display="none");a.iframe.parentNode.style.height="100%";a.iframe.parentNode.parentNode.style.height="100%"}catch(g){}else window.setTimeout(function(){try{a.document.body.style.minHeight=a.document.documentElement.clientHeight-20+"px"}catch(b){}},300)},_setup:function(b){var a=this.options,c=this;!browser.webkit&&b.open();var g=ie&&9>browser.version;b.write((ie&&9>browser.version?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"'+
(!g?' class="view"':"")+"><head>"+(a.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+utils.unhtml(/^http/.test(a.iframeCssUrl)?a.iframeCssUrl:a.UEDITOR_HOME_URL+a.iframeCssUrl)+'"/>':"")+'<style type="text/css">'+(a.initialStyle||" ")+"</style></head><body"+(g?' class="view"':"")+"></body></html>");!browser.webkit&&b.close();ie?(b.body.disabled=!0,b.body.contentEditable=!0,b.body.disabled=!1):(b.body.contentEditable=!0,b.body.spellcheck=!1);this.document=b;this.window=b.defaultView||
b.parentWindow;this.iframe=this.window.frameElement;this.body=b.body;this.options.minFrameHeight&&(this.setHeight(this.options.minFrameHeight),this.body.style.height=this.options.minFrameHeight);this.selection=new dom.Selection(b);browser.gecko&&this.selection.getNative().removeAllRanges();this._initEvents();if(c.options.initialContent)if(c.options.autoClearinitialContent){var j=c.execCommand;c.execCommand=function(){c.fireEvent("firstBeforeExecCommand");j.apply(c,arguments)};this.setDefaultContent(this.options.initialContent)}else this.setContent(this.options.initialContent,
!0);for(b=this.iframe.parentNode;!domUtils.isBody(b);b=b.parentNode)if("FORM"==b.tagName){domUtils.on(b,"submit",function(){var b=document.getElementById("ueditor_textarea_"+c.options.textarea);if(!b){b=document.createElement("textarea");b.setAttribute("name",c.options.textarea);b.id="ueditor_textarea_"+c.options.textarea;b.style.display="none";this.appendChild(b)}b.value=c.getContent()});break}domUtils.isEmptyNode(c.body)&&(this.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>");c.options.focus&&
setTimeout(function(){c.focus();!c.options.autoClearinitialContent&&c._selectionChange()});this.container||(this.container=this.iframe.parentNode);c.options.fullscreen&&c.ui&&c.ui.setFullScreen(!0);this.fireEvent("ready");if(!browser.ie)domUtils.on(c.window,"blur",function(){c._bakRange=c.selection.getRange();c.selection.getNative().removeAllRanges()});browser.gecko&&10902>=browser.version&&(c.body.contentEditable=!1,setTimeout(function(){c.body.contentEditable=true},100),setInterval(function(){c.body.style.height=
c.iframe.offsetHeight-20+"px"},100))},sync:function(b){function a(b){var e=document.getElementById("ueditor_textarea_"+c.options.textarea);e||(e=document.createElement("textarea"),e.setAttribute("name",c.options.textarea),e.id="ueditor_textarea_"+c.options.textarea,e.style.display="none",b.appendChild(e));e.value=c.getContent()}var c=this;if(b)(b=document.getElementById(b))&&a(b);else for(b=c.iframe.parentNode;!domUtils.isBody(b);b=b.parentNode)if("FORM"==b.tagName){a(b);break}},setHeight:function(b){b!==
parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=b+"px");browser.ie&&9==browser.version&&(this.document.body.style.height=b-20+"px")},getContent:function(b){this.fireEvent("beforegetcontent",b);var a=this.document.body.innerHTML.replace(RegExp(domUtils.fillChar,"g"),"").replace(/>[\t\r\n]*?</g,"><");this.fireEvent("aftergetcontent",b);this.serialize&&(b=this.serialize.parseHTML(a),b=this.serialize.transformOutput(b),a=this.serialize.toHTML(b));return a},getContentTxt:function(){return this.body[browser.ie?
"innerText":"textContent"].replace(RegExp(domUtils.fillChar,"g"),"")},setContent:function(b,e){var c=utils.extend({a:1,A:1},dtd.$inline,!0),g,b=b.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(b,a,f){a?g=f:a=g;return!c[a]&&!c[f]?b.replace(/>[ \t\r\n]*?</,"><"):b});this.fireEvent("beforesetcontent");var j=this.serialize;if(j)var f=j.parseHTML(b),f=j.transformInput(f),f=j.filter(f),b=j.toHTML(f);this.document.body.innerHTML=
b.replace(RegExp("[\r"+domUtils.fillChar+"]*","g"),"");browser.ie&&(7>browser.version&&this.options.relativePath)&&a(this.document.body);if("p"==this.options.enterTag){var j=this.body.firstChild,f=this.document.createElement("p"),d;if(!j||1==j.nodeType&&dtd.$cdata[j.tagName])this.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"+this.body.innerHTML;else for(;j;)3==j.nodeType||1==j.nodeType&&dtd.p[j.tagName]?(d=j.nextSibling,f.appendChild(j),(j=d)||this.body.appendChild(f)):(f.firstChild&&(this.body.insertBefore(f,
j),f=this.document.createElement("p")),j=j.nextSibling)}this.adjustTable&&this.adjustTable(this.body);this.fireEvent("aftersetcontent");this.fireEvent("contentchange");!e&&this._selectionChange();this._bakRange=this._bakIERange=null;browser.gecko&&this.selection.getNative().removeAllRanges()},focus:function(){try{this.selection.getRange().select(!0)}catch(b){}},_initEvents:function(){var b=this,a=b.document,c=b.window;b._proxyDomEvent=utils.bind(b._proxyDomEvent,b);domUtils.on(a,"click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart".split(" "),
b._proxyDomEvent);domUtils.on(c,["focus","blur"],b._proxyDomEvent);domUtils.on(a,["mouseup","keydown"],function(a){"keydown"==a.type&&(a.ctrlKey||a.metaKey||a.shiftKey||a.altKey)||2!=a.button&&b._selectionChange(250,a)});var g=0,a=browser.ie?b.body:b.document,j;domUtils.on(a,"dragstart",function(){g=1});domUtils.on(a,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(j);j=setTimeout(function(){if(!g){var a=b.selection.getRange();if(a&&(a=a.getCommonAncestor())&&
b.serialize){var e=b.serialize,c=e.filter(e.transformInput(e.parseHTML(e.word(a.innerHTML))));a.innerHTML=e.toHTML(c)}}g=0},200)}:function(b){g||(b.preventDefault?b.preventDefault():b.returnValue=!1);g=0}}())},_proxyDomEvent:function(b){return this.fireEvent(b.type.replace(/^on/,""),b)},_selectionChange:function(b,a){var i=this;if(i.selection.isFocus()){var g=!1,j,f;browser.ie&&(9>browser.version&&a&&"mouseup"==a.type)&&!this.selection.getRange().collapsed&&(g=!0,j=a.clientX,f=a.clientY);clearTimeout(c);
c=setTimeout(function(){if(i.selection.getNative()){var b;if(g&&i.selection.getNative().type=="None"){b=i.document.body.createTextRange();try{b.moveToPoint(j,f)}catch(c){b=null}}var d;if(b){d=i.selection.getIERange;i.selection.getIERange=function(){return b}}i.selection.cache();if(d)i.selection.getIERange=d;if(i.selection._cachedRange&&i.selection._cachedStartElement){i.fireEvent("beforeselectionchange");i.fireEvent("selectionchange",!!a);i.fireEvent("afterselectionchange");i.selection.clear()}}},
b||50)}},_callCmdFn:function(b,a){var c=a[0].toLowerCase(),g,c=(g=this.commands[c])&&g[b]||(g=UE.commands[c])&&g[b];if(g&&!c&&"queryCommandState"==b)return!1;if(c)return c.apply(this,a)},execCommand:function(b){var b=b.toLowerCase(),a,c=this.commands[b]||UE.commands[b];if(c&&c.execCommand)return!c.notNeedUndo&&!this.__hasEnterExecCommand?(this.__hasEnterExecCommand=!0,-1!=this.queryCommandState(b)&&(this.fireEvent("beforeexeccommand",b),a=this._callCmdFn("execCommand",arguments),this.fireEvent("afterexeccommand",
b)),this.__hasEnterExecCommand=!1):a=this._callCmdFn("execCommand",arguments),this._selectionChange(),a},queryCommandState:function(b){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(b){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(b){if(b)for(var a=0,c;c=b[a++];)if(0<this.document.getElementsByTagName(c).length)return!0;return!domUtils.isEmptyBlock(this.body)?!0:!1},reset:function(){this.fireEvent("reset")},setDefaultContent:function(){function b(){var a=
this;if(a.document.getElementById("initContent")){a.document.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";var c=a.selection.getRange();a.removeListener("firstBeforeExecCommand",b);a.removeListener("focus",b);setTimeout(function(){c.setStart(a.document.body.firstChild,0).collapse(!0).select(!0);a._selectionChange()})}}return function(c){this.document.body.innerHTML='<p id="initContent">'+c+"</p>";browser.ie&&(7>browser.version&&this.options.relativePath)&&a(this.document.body);this.addListener("firstBeforeExecCommand",
b);this.addListener("focus",b)}}()};utils.inherits(h,EventBase)})();UE.ajax=function(){function a(a){var d=[],b;for(b in a)"method"==b||"timeout"==b||"async"==b||"function"==(typeof a[b]).toLowerCase()||"object"==(typeof a[b]).toLowerCase()||d.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return d.join("&")}function d(){var a=null;if(window.XMLHttpRequest)a=new XMLHttpRequest;else try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}return a}return{request:function(c,h){var b=d(),e=!1,i={method:"POST",
timeout:5E3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};"object"===typeof c&&(h=c,c=h.url);if(b&&c){var g=h?utils.extend(i,h):i,i=a(g);utils.isEmptyObject(g.data)||(i+=(i?"&":"")+a(g.data));var j=setTimeout(function(){if(b.readyState!=4){e=true;b.abort();clearTimeout(j)}},g.timeout),f=g.method.toUpperCase(),m=c+(-1==c.indexOf("?")?"?":"&")+("POST"==f?"":i)+"&noCache="+ +new Date;b.open(f,m,g.async);b.onreadystatechange=function(){if(b.readyState==4)if(!e&&b.status==200)g.onsuccess(b);
else g.onerror(b)};"POST"==f?(b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),b.send(i)):b.send(null)}}}}();UE.commands.inserthtml={execCommand:function(a,d){var c=this,h,b,e,i=c.currentSelectedArr;h=c.selection.getRange();e=h.document.createElement("div");e.style.display="inline";e.innerHTML=utils.trim(d);try{c.adjustTable&&c.adjustTable(e)}catch(g){}if(i&&i.length){b=0;for(var j;j=i[b++];)j.className="";i[0].innerHTML="";h.setStart(i[0],0).collapse(!0);c.currentSelectedArr=[]}if(!h.collapsed&&(h.deleteContents(),1==h.startContainer.nodeType)){b=h.startContainer.childNodes[h.startOffset];var f;if(b&&domUtils.isBlockElm(b)&&
(f=b.previousSibling)&&domUtils.isBlockElm(f)){for(h.setEnd(f,f.childNodes.length).collapse();b.firstChild;)f.appendChild(b.firstChild);domUtils.remove(b)}}for(var m,i=0;b=e.firstChild;){h.insertNode(b);if(!i&&b.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(b)&&(j=domUtils.findParent(b,function(b){return domUtils.isBlockElm(b)}))&&"body"!=j.tagName.toLowerCase()&&!(dtd[j.tagName][b.nodeName]&&b.parentNode===j)){if(dtd[j.tagName][b.nodeName])for(m=b.parentNode;m!==j;)f=m,m=m.parentNode;else f=
j;domUtils.breakParent(b,f||m);f=b.previousSibling;domUtils.trimWhiteTextNode(f);f.childNodes.length||domUtils.remove(f);i=1}j=b.nextSibling;if(!e.firstChild&&j&&domUtils.isBlockElm(j)){h.setStart(j,0).collapse(!0);break}h.setEndAfter(b).collapse()}b=h.startContainer;domUtils.isBlockElm(b)&&domUtils.isEmptyNode(b)&&(b.innerHTML=browser.ie?"":"<br/>");h.select(!0);setTimeout(function(){h=c.selection.getRange();h.scrollToView(c.autoHeightEnabled,c.autoHeightEnabled?domUtils.getXY(c.iframe).y:0)},200)}};UE.plugins.autotypeset=function(){function a(b,a){if(b&&b.parentNode&&g[b.tagName.toLowerCase()])return j&&j.contains(b)||b.getAttribute("pagebreak")?0:a?!domUtils.isEmptyBlock(b):domUtils.isEmptyBlock(b)}function d(b){b.style.cssText||(domUtils.removeAttributes(b,["style"]),"span"==b.tagName.toLowerCase()&&domUtils.hasNoAttributes(b)&&domUtils.remove(b,!0))}function c(g,c){if(browser.ie)try{var l=h.serialize;if(l){var k=l.parseHTML(c.html),k=l.transformInput(k),k=l.filter(k);c.html=l.toHTML(k)}}catch(n){}if(c){if(!b.pasteFilter)return;
l=h.document.createElement("div");l.innerHTML=c.html}else l=h.document.body;for(var k=domUtils.getElementsByTagName(l,"*"),t=0,q;q=k[t++];){!j&&("DIV"==q.tagName&&q.getAttribute("highlighter"))&&(j=q);b.clearFontSize&&q.style.fontSize&&(q.style.fontSize="",d(q));b.clearFontFamily&&q.style.fontFamily&&(q.style.fontFamily="",d(q));if(a(q)){if(b.mergeEmptyline)for(var o=q.nextSibling,s;a(o);)s=o,o=s.nextSibling,domUtils.remove(s);if(b.removeEmptyline&&domUtils.inDoc(q,l)&&!i[q.parentNode.tagName.toLowerCase()]){domUtils.remove(q);
continue}}if(a(q,!0)&&(b.indent&&(q.style.textIndent=b.indentValue),b.textAlign))q.style.textAlign=b.textAlign;if(b.removeClass&&q.className&&!e[q.className.toLowerCase()]){if(j&&j.contains(q))continue;domUtils.removeAttributes(q,["class"])}if(b.imageBlockLine&&"img"==q.tagName.toLowerCase()&&!q.getAttribute("emotion"))if(c){var r=q;switch(b.imageBlockLine){case "left":case "right":case "none":for(var o=r.parentNode,u;dtd.$inline[o.tagName]||"A"==o.tagName;)o=o.parentNode;s=o;if("P"==s.tagName&&"center"==
domUtils.getStyle(s,"text-align")&&!domUtils.isBody(s)&&1==domUtils.getChildCount(s,function(b){return!domUtils.isBr(b)&&!domUtils.isWhitespace(b)}))if(u=s.previousSibling,o=s.nextSibling,u&&o&&1==u.nodeType&&1==o.nodeType&&u.tagName==o.tagName&&domUtils.isBlockElm(u)){for(u.appendChild(s.firstChild);o.firstChild;)u.appendChild(o.firstChild);domUtils.remove(s);domUtils.remove(o)}else domUtils.setStyle(s,"text-align","");domUtils.setStyle(r,"float",b.imageBlockLine);break;case "center":if("center"!=
h.queryCommandValue("imagefloat")){o=r.parentNode;domUtils.setStyle(r,"float","none");for(s=r;o&&1==domUtils.getChildCount(o,function(b){return!domUtils.isBr(b)&&!domUtils.isWhitespace(b)})&&(dtd.$inline[o.tagName]||"A"==o.tagName);)s=o,o=o.parentNode;r=h.document.createElement("p");domUtils.setAttributes(r,{style:"text-align:center"});s.parentNode.insertBefore(r,s);r.appendChild(s);domUtils.setStyle(s,"float","")}}}else h.selection.getRange().selectNode(q).select(),h.execCommand("imagefloat",b.imageBlockLine);
b.removeEmptyNode&&b.removeTagNames[q.tagName.toLowerCase()]&&(domUtils.hasNoAttributes(q)&&domUtils.isEmptyBlock(q))&&domUtils.remove(q)}c&&(c.html=l.innerHTML)}if(this.options.autotypeset){var h=this,b=h.options.autotypeset,e={selectTdClass:1,pagebreak:1,anchorclass:1},i={li:1},g={div:1,p:1},j;b.pasteFilter&&h.addListener("beforepaste",c);h.commands.autotypeset={execCommand:function(){h.removeListener("beforepaste",c);b.pasteFilter&&h.addListener("beforepaste",c);c()}}}};UE.commands.imagefloat={execCommand:function(a,d){var c=this.selection.getRange();if(!c.collapsed){var h=c.getClosedNode();if(h&&"IMG"==h.tagName)switch(d){case "left":case "right":case "none":for(var b=h.parentNode,e,i;dtd.$inline[b.tagName]||"A"==b.tagName;)b=b.parentNode;e=b;if("P"==e.tagName&&"center"==domUtils.getStyle(e,"text-align")){if(!domUtils.isBody(e)&&1==domUtils.getChildCount(e,function(b){return!domUtils.isBr(b)&&!domUtils.isWhitespace(b)}))if(b=e.previousSibling,i=e.nextSibling,b&&
i&&1==b.nodeType&&1==i.nodeType&&b.tagName==i.tagName&&domUtils.isBlockElm(b)){for(b.appendChild(e.firstChild);i.firstChild;)b.appendChild(i.firstChild);domUtils.remove(e);domUtils.remove(i)}else domUtils.setStyle(e,"text-align","");c.selectNode(h).select()}domUtils.setStyle(h,"float",d);break;case "center":if("center"!=this.queryCommandValue("imagefloat")){b=h.parentNode;domUtils.setStyle(h,"float","none");for(e=h;b&&1==domUtils.getChildCount(b,function(b){return!domUtils.isBr(b)&&!domUtils.isWhitespace(b)})&&
(dtd.$inline[b.tagName]||"A"==b.tagName);)e=b,b=b.parentNode;c.setStartBefore(e).setCursor(!1);b=this.document.createElement("div");b.appendChild(e);domUtils.setStyle(e,"float","");this.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+b.innerHTML+"</p>");e=this.document.getElementById("_img_parent_tmp");e.removeAttribute("id");e=e.firstChild;c.selectNode(e).select();(i=e.parentNode.nextSibling)&&domUtils.isEmptyNode(i)&&domUtils.remove(i)}}}},queryCommandValue:function(){var a=
this.selection.getRange(),d;return a.collapsed?"none":(a=a.getClosedNode())&&1==a.nodeType&&"IMG"==a.tagName?(d=domUtils.getComputedStyle(a,"float"),"none"==d&&(d="center"==domUtils.getComputedStyle(a.parentNode,"text-align")?"center":d),{left:1,right:1,center:1}[d]?d:"none"):"none"},queryCommandState:function(){if(this.highlight)return-1;var a=this.selection.getRange();return a.collapsed?-1:(a=a.getClosedNode())&&1==a.nodeType&&"IMG"==a.tagName?0:-1}};
UE.commands.insertimage={execCommand:function(a,d){d=utils.isArray(d)?d:[d];if(d.length){var c=this.selection.getRange(),h=c.getClosedNode();if(h&&/img/i.test(h.tagName)&&"edui-faked-video"!=h.className&&!h.getAttribute("word_img")){var b=d.shift(),e=b.floatStyle;delete b.floatStyle;domUtils.setAttributes(h,b);this.execCommand("imagefloat",e);0<d.length&&(c.setStartAfter(h).setCursor(!1,!0),this.execCommand("insertimage",d))}else{c=[];h="";b=d[0];if(1==d.length)h='<img src="'+b.src+'" '+(b.data_ue_src?
' data_ue_src="'+b.data_ue_src+'" ':"")+(b.width?'width="'+b.width+'" ':"")+(b.height?' height="'+b.height+'" ':"")+(b.floatStyle&&"center"!=b.floatStyle?' style="float:'+b.floatStyle+';"':"")+(b.title?' title="'+b.title+'"':"")+' border="'+(b.border||0)+'" hspace = "'+(b.hspace||0)+'" vspace = "'+(b.vspace||0)+'" />',"center"==b.floatStyle&&(h='<p style="text-align: center">'+h+"</p>"),c.push(h);else for(e=0;b=d[e++];)h="<p "+("center"==b.floatStyle?'style="text-align: center" ':"")+'><img src="'+
b.src+'" '+(b.width?'width="'+b.width+'" ':"")+(b.data_ue_src?' data_ue_src="'+b.data_ue_src+'" ':"")+(b.height?' height="'+b.height+'" ':"")+' style="'+(b.floatStyle&&"center"!=b.floatStyle?"float:"+b.floatStyle+";":"")+(b.border||"")+'" '+(b.title?' title="'+b.title+'"':"")+" /></p>",c.push(h);this.execCommand("insertHtml",c.join(""))}}},queryCommandState:function(){return this.highlight?-1:0}};(function(){var a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"},d;for(d in a)(function(a,d){UE.commands[a]={execCommand:function(b,e){var e=e||(this.queryCommandState(b)?"none":"underline"==b?"underline":"line-through"),i=this.selection.getRange(),g;if("default"==e){if(i.collapsed&&(g=this.document.createTextNode("font"),i.insertNode(g).select()),this.execCommand("removeFormat","span,a",d),
g)i.setStartBefore(g).setCursor(),domUtils.remove(g)}else if(this.currentSelectedArr&&0<this.currentSelectedArr.length){g=0;for(var j;j=this.currentSelectedArr[g++];)i.selectNodeContents(j),i.applyInlineStyle("span",{style:d+":"+e});i.selectNodeContents(this.currentSelectedArr[0]).select()}else if(i.collapsed){j=domUtils.findParentByTagName(i.startContainer,"span",!0);g=this.document.createTextNode("font");if(j&&!j.children.length&&!j[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){i.insertNode(g);
if("underline"==a||"strikethrough"==a)i.selectNode(g).select(),this.execCommand("removeFormat","span,a",d,null),j=domUtils.findParentByTagName(g,"span",!0),i.setStartBefore(g);j.style.cssText=j.style.cssText+";"+d+":"+e;i.collapse(!0).select()}else{i.insertNode(g);i.selectNode(g).select();j=i.document.createElement("span");if("underline"==a||"strikethrough"==a){if(domUtils.findParentByTagName(g,"a",!0)){i.setStartBefore(g).setCursor();domUtils.remove(g);return}this.execCommand("removeFormat","span,a",
d)}j.style.cssText=d+":"+e;g.parentNode.insertBefore(j,g);if(!browser.ie||browser.ie&&9==browser.version)for(var f=j.parentNode;!domUtils.isBlockElm(f);)"SPAN"==f.tagName&&(j.style.cssText=f.style.cssText+j.style.cssText),f=f.parentNode;i.setStart(j,0).setCursor()}domUtils.remove(g)}else("underline"==a||"strikethrough"==a)&&this.queryCommandValue(a)&&this.execCommand("removeFormat","span,a",d),i=this.selection.getRange(),i.applyInlineStyle("span",{style:d+":"+e}).select();return!0},queryCommandValue:function(b){var a=
this.selection.getStart();if("underline"==b||"strikethrough"==b){for(b=a;b&&!domUtils.isBlockElm(b)&&!domUtils.isBody(b);){if(1==b.nodeType&&(a=domUtils.getComputedStyle(b,d),"none"!=a))return a;b=b.parentNode}return"none"}return domUtils.getComputedStyle(a,d)},queryCommandState:function(b){return this.highlight?-1:!("underline"==b||"strikethrough"==b)?0:this.queryCommandValue(b)==("underline"==b?"underline":"line-through")}}})(d,a[d])})();(function(){function a(a){var d=a.startContainer,b=a.endContainer;(d=domUtils.findParentByTagName(d,"a",!0))&&a.setStartBefore(d);(b=domUtils.findParentByTagName(b,"a",!0))&&a.setEndAfter(b)}function d(c,d){a(c=c.adjustmentBoundary());var b=c.startContainer;if(1==b.nodeType&&(b=b.childNodes[c.startOffset])&&1==b.nodeType&&"A"==b.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(b[browser.ie?"innerText":"textContent"]))b.innerHTML=d.href;c.removeInlineStyle("a");if(c.collapsed){var b=c.document.createElement("a"),
e="";d.textValue?(e=d.textValue,delete d.textValue):e=d.href;domUtils.setAttributes(b,d);b[browser.ie?"innerText":"textContent"]=e;c.insertNode(b).selectNode(b)}else c.applyInlineStyle("a",d)}UE.commands.unlink={execCommand:function(){var c,d=new dom.Range(this.document),b=this.currentSelectedArr;if(b&&0<b.length){for(var e=0;c=b[e++];){c=domUtils.getElementsByTagName(c,"a");for(var i=0,g;g=c[i++];)domUtils.remove(g,!0)}domUtils.isEmptyNode(b[0])?d.setStart(b[0],0).setCursor():d.selectNodeContents(b[0]).select()}else if(d=
this.selection.getRange(),!d.collapsed||domUtils.findParentByTagName(d.startContainer,"a",!0))b=d.createBookmark(),a(d),d.removeInlineStyle("a").moveToBookmark(b).select()},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};UE.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(a,h){var b=new dom.Range(this.document),e=this.currentSelectedArr;if(e&&e.length){for(var i=0,g;g=e[i++];)domUtils.isEmptyNode(g)&&(g.innerHTML=
h.href),d(b.selectNodeContents(g),h);b.selectNodeContents(e[0]).select()}else d(b=this.selection.getRange(),h),b.collapse().select(browser.gecko?!0:!1)},queryCommandValue:function(){var a=new dom.Range(this.document),d=this.currentSelectedArr,b,e;if(d&&d.length)for(var a=0,i;i=d[a++];){if(b=i.getElementsByTagName("a"),b[0])return b[0]}else if(a=this.selection.getRange(),a.collapsed){if((e=this.selection.getStart())&&(e=domUtils.findParentByTagName(e,"a",!0)))return e}else{a.shrinkBoundary();d=3==
a.startContainer.nodeType||!a.startContainer.childNodes[a.startOffset]?a.startContainer:a.startContainer.childNodes[a.startOffset];i=3==a.endContainer.nodeType||0==a.endOffset?a.endContainer:a.endContainer.childNodes[a.endOffset-1];a=a.getCommonAncestor();e=domUtils.findParentByTagName(a,"a",!0);if(!e&&1==a.nodeType){b=a.getElementsByTagName("a");for(var g,j,a=0,f;f=b[a++];)if(g=domUtils.getPosition(f,d),j=domUtils.getPosition(f,i),(g&domUtils.POSITION_FOLLOWING||g&domUtils.POSITION_CONTAINS)&&(j&
domUtils.POSITION_PRECEDING||j&domUtils.POSITION_CONTAINS)){e=f;break}}return e}}}})();UE.commands.removeformat={execCommand:function(a,d,c,h,b){function e(b){if(3==b.nodeType||"span"!=b.tagName.toLowerCase())return 0;if(browser.ie){var a=b.attributes;if(a.length){for(var b=0,g=a.length;b<g;b++)if(a[b].specified)return 0;return 1}}return!b.attributes.length}function i(a){var i=a.createBookmark();a.collapsed&&a.enlarge(!0);if(!b){var d=domUtils.findParentByTagName(a.startContainer,"a",!0);d&&a.setStartBefore(d);(d=domUtils.findParentByTagName(a.endContainer,"a",!0))&&a.setEndAfter(d)}f=
a.createBookmark();for(d=f.start;(m=d.parentNode)&&!domUtils.isBlockElm(m);)domUtils.breakParent(d,m),domUtils.clearEmptySibling(d);if(f.end){for(d=f.end;(m=d.parentNode)&&!domUtils.isBlockElm(m);)domUtils.breakParent(d,m),domUtils.clearEmptySibling(d);for(var d=domUtils.getNextDomNode(f.start,!1,l),h;d&&d!=f.end;)h=domUtils.getNextDomNode(d,!0,l),!dtd.$empty[d.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(d)&&(g.test(d.tagName)?c?(domUtils.removeStyle(d,c),e(d)&&"text-decoration"!=c&&domUtils.remove(d,
!0)):domUtils.remove(d,!0):!dtd.$tableContent[d.tagName]&&!dtd.$list[d.tagName]&&(domUtils.removeAttributes(d,j),e(d)&&domUtils.remove(d,!0))),d=h}d=f.start.parentNode;domUtils.isBlockElm(d)&&(!dtd.$tableContent[d.tagName]&&!dtd.$list[d.tagName])&&domUtils.removeAttributes(d,j);d=f.end.parentNode;f.end&&(domUtils.isBlockElm(d)&&!dtd.$tableContent[d.tagName]&&!dtd.$list[d.tagName])&&domUtils.removeAttributes(d,j);a.moveToBookmark(f).moveToBookmark(i);d=a.startContainer;for(h=a.collapsed;1==d.nodeType&&
domUtils.isEmptyNode(d)&&dtd.$removeEmpty[d.tagName];)i=d.parentNode,a.setStartBefore(d),a.startContainer===a.endContainer&&a.endOffset--,domUtils.remove(d),d=i;if(!h)for(d=a.endContainer;1==d.nodeType&&domUtils.isEmptyNode(d)&&dtd.$removeEmpty[d.tagName];)i=d.parentNode,a.setEndBefore(d),domUtils.remove(d),d=i}var g=RegExp("^(?:"+(d||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),j=c?[]:(h||this.options.removeFormatAttributes).split(","),a=new dom.Range(this.document),f,m,l=function(b){return 1==
b.nodeType};if(this.currentSelectedArr&&this.currentSelectedArr.length){for(d=0;h=this.currentSelectedArr[d++];)a.selectNodeContents(h),i(a);a.selectNodeContents(this.currentSelectedArr[0]).select()}else a=this.selection.getRange(),i(a),a.select()},queryCommandState:function(){return this.highlight?-1:0}};(function(){UE.commands.blockquote={execCommand:function(a,d){var c=this.selection.getRange(),h=utils.findNode(this.selection.getStartElementPath(),["blockquote"]),b=dtd.blockquote,e=c.createBookmark(),i=this.currentSelectedArr;if(h)if(i&&i.length)domUtils.remove(h,!0);else{b=c.startContainer;b=domUtils.isBlockElm(b)?b:domUtils.findParent(b,function(b){return domUtils.isBlockElm(b)});i=c.endContainer;i=domUtils.isBlockElm(i)?i:domUtils.findParent(i,function(b){return domUtils.isBlockElm(b)});b=domUtils.findParentByTagName(b,
"li",!0)||b;i=domUtils.findParentByTagName(i,"li",!0)||i;"LI"==b.tagName||"TD"==b.tagName||b===h?domUtils.remove(h,!0):domUtils.breakParent(b,h);b!==i&&(h=domUtils.findParentByTagName(i,"blockquote"))&&("LI"==i.tagName||"TD"==i.tagName?domUtils.remove(h,!0):domUtils.breakParent(i,h));for(var g=domUtils.getElementsByTagName(this.document,"blockquote"),h=0,j;j=g[h++];)j.childNodes.length?domUtils.getPosition(j,b)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(j,i)&domUtils.POSITION_PRECEDING&&domUtils.remove(j,
!0):domUtils.remove(j)}else{h=c.cloneRange();g=i=1==h.startContainer.nodeType?h.startContainer:h.startContainer.parentNode;for(j=1;;){if(domUtils.isBody(i)){g!==i?c.collapsed?(h.selectNode(g),j=0):h.setStartBefore(g):h.setStart(i,0);break}if(!b[i.tagName]){c.collapsed?h.selectNode(g):h.setStartBefore(g);break}g=i;i=i.parentNode}if(j)for(g=i=i=1==h.endContainer.nodeType?h.endContainer:h.endContainer.parentNode;;){if(domUtils.isBody(i)){g!==i?h.setEndAfter(g):h.setEnd(i,i.childNodes.length);break}if(!b[i.tagName]){h.setEndAfter(g);
break}g=i;i=i.parentNode}i=c.document.createElement("blockquote");domUtils.setAttributes(i,d);i.appendChild(h.extractContents());h.insertNode(i);b=domUtils.getElementsByTagName(i,"blockquote");for(h=0;i=b[h++];)i.parentNode&&domUtils.remove(i,!0)}c.moveToBookmark(e).select()},queryCommandState:function(){return this.highlight?-1:utils.findNode(this.selection.getStartElementPath(),["blockquote"])?1:0}}})();(function(){var a=domUtils.isBlockElm,d=["TD","LI","PRE"],c=function(c,b,e,i){var g=c.createBookmark(),j=function(b){return 1==b.nodeType?"br"!=b.tagName.toLowerCase()&&!domUtils.isBookmarkNode(b):!domUtils.isWhitespace(b)},f;c.enlarge(!0);var m=c.createBookmark();f=domUtils.getNextDomNode(m.start,!1,j);for(var l=c.cloneRange(),k;f&&!(domUtils.getPosition(f,m.end)&domUtils.POSITION_FOLLOWING);)if(3==f.nodeType||!a(f)){for(l.setStartBefore(f);f&&f!==m.end&&!a(f);)k=f,f=domUtils.getNextDomNode(f,!1,
null,function(b){return!a(b)});l.setEndAfter(k);f=c.document.createElement(b);e&&(domUtils.setAttributes(f,e),i&&("customstyle"==i&&e.style)&&(f.style.cssText=e.style));f.appendChild(l.extractContents());domUtils.isEmptyNode(f)&&domUtils.fillChar(c.document,f);l.insertNode(f);var n=f.parentNode;a(n)&&(!domUtils.isBody(f.parentNode)&&-1==utils.indexOf(d,n.tagName))&&((i&&"customstyle"==i||(n.getAttribute("dir")&&f.setAttribute("dir",n.getAttribute("dir")),n.style.cssText&&(f.style.cssText=n.style.cssText+
";"+f.style.cssText),n.style.textAlign&&!f.style.textAlign&&(f.style.textAlign=n.style.textAlign),n.style.textIndent&&!f.style.textIndent&&(f.style.textIndent=n.style.textIndent),n.style.padding&&!f.style.padding&&(f.style.padding=n.style.padding)),e&&/h\d/i.test(n.tagName)&&!/h\d/i.test(f.tagName))?(domUtils.setAttributes(n,e),i&&("customstyle"==i&&e.style)&&(n.style.cssText=e.style),domUtils.remove(f,!0),f=n):domUtils.remove(f.parentNode,!0));f=-1!=utils.indexOf(d,n.tagName)?n:f;f=domUtils.getNextDomNode(f,
!1,j)}else f=domUtils.getNextDomNode(f,!0,j);return c.moveToBookmark(m).moveToBookmark(g)};UE.commands.paragraph={execCommand:function(a,b,e,d){a=new dom.Range(this.document);if(this.currentSelectedArr&&0<this.currentSelectedArr.length){for(var g=0,j;j=this.currentSelectedArr[g++];)if("none"!=j.style.display){if(domUtils.isEmptyNode(j)){var f=this.document.createTextNode("paragraph");j.innerHTML="";j.appendChild(f)}c(a.selectNodeContents(j),b,e,d);f&&(j=f.parentNode,domUtils.remove(f),domUtils.isEmptyNode(j)&&
domUtils.fillNode(this.document,j))}b=this.currentSelectedArr[0];domUtils.isEmptyBlock(b)?a.setStart(b,0).setCursor(!1,!0):a.selectNode(b).select()}else a=this.selection.getRange(),a.collapsed&&(g=this.document.createTextNode("p"),a.insertNode(g),browser.ie&&((f=g.previousSibling)&&domUtils.isWhitespace(f)&&domUtils.remove(f),(f=g.nextSibling)&&domUtils.isWhitespace(f)&&domUtils.remove(f))),a=c(a,b,e,d),g&&(a.setStartBefore(g).collapse(!0),j=g.parentNode,domUtils.remove(g),domUtils.isBlockElm(j)&&
domUtils.isEmptyNode(j)&&domUtils.fillNode(this.document,j)),browser.gecko&&a.collapsed&&1==a.startContainer.nodeType&&(e=a.startContainer.childNodes[a.startOffset])&&(1==e.nodeType&&e.tagName.toLowerCase()==b)&&a.setStart(e,0).collapse(!0),a.select();return!0},queryCommandValue:function(){var a=utils.findNode(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6".split(" "));return a?a.tagName.toLowerCase():""},queryCommandState:function(){return this.highlight?-1:0}}})();UE.commands.horizontal={execCommand:function(a){if(-1!==this.queryCommandState(a)){this.execCommand("insertHtml","<hr>");var a=this.selection.getRange(),d=a.startContainer;if(1==d.nodeType&&!d.childNodes[a.startOffset]){var c;if((c=d.childNodes[a.startOffset-1])&&1==c.nodeType&&"HR"==c.tagName)"p"==this.options.enterTag?(c=this.document.createElement("p"),a.insertNode(c),a.setStart(c,0).setCursor()):(c=this.document.createElement("br"),a.insertNode(c),a.setStartBefore(c).setCursor())}return!0}},queryCommandState:function(){return this.highlight||
utils.findNode(this.selection.getStartElementPath(),["table"])?-1:0}};UE.plugins.undo=function(){function a(b){this.collapsed=b.collapsed;this.startAddr=d(b.startContainer,b.startOffset);this.endAddr=b.collapsed?this.startAddr:d(b.endContainer,b.endOffset)}function d(b,a){for(var g=0,f=[a],e,c=domUtils.findParents(b,!0,function(b){return!domUtils.isBody(b)},!0);e=c[g++];){if(1==g&&3==e.nodeType){for(var d=e;d=d.previousSibling;)if(3==d.nodeType)a+=d.nodeValue.replace(fillCharReg,"").length;else break;f[0]=a}f.push(domUtils.getNodeIndex(e,!0))}return f.reverse()}function c(b,
a){if(b.length!=a.length)return 0;for(var g=0,f=b.length;g<f;g++)if(b[g]!=a[g])return 0;return 1}function h(b,a,g){for(var f=b.document.body,e=0,f,c=g.length-1;e<c;e++)f=f.childNodes[g[e]];b[a+"Container"]=f;b[a+"Offset"]=g[g.length-1]}function b(){this.undoManger.save()}var e=this,i=e.options.maxUndoCount||20,g=e.options.maxInputCount||20,j=RegExp(domUtils.fillChar+"|</hr>","gi"),f=/\b(?:href|src|name)="[^"]*?"/gi;a.prototype={compare:function(b){return e.collapsed!==b.collapsed||!c(e.startAddr,
b.startAddr)||!c(e.endAddr,b.endAddr)?0:1},transformRange:function(b){b.collapsed=this.collapsed;h(b,"start",this.startAddr);b.collapsed?b.collapse(!0):h(b,"end",this.endAddr)}};e.undoManger=new function(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=!1;this.undo=function(){if(this.hasUndo){var b=this.getScene();this.list[this.index].content.replace(f,"")!=b.content.replace(f,"")&&this.save();if(!this.list[this.index-1]&&1==this.list.length)this.reset();else{for(;this.list[this.index].content==
this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}}};this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}};this.restore=function(){var b=this.list[this.index];e.document.body.innerHTML=b.bookcontent.replace(j,"");if(browser.ie)for(var a=0,g,f=e.document.getElementsByTagName("p");g=
f[a++];)""==g.innerHTML&&domUtils.fillNode(e.document,g);var c=new dom.Range(e.document);try{browser.opera||browser.safari?b.senceRange.transformRange(c):c.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:!0}),browser.ie&&(9==browser.version&&c.collapsed&&domUtils.isBlockElm(c.startContainer)&&domUtils.isEmptyNode(c.startContainer))&&domUtils.fillNode(c.document,c.startContainer),c.select(!browser.gecko),!browser.opera&&!browser.safari&&setTimeout(function(){c.scrollToView(e.autoHeightEnabled,
e.autoHeightEnabled?domUtils.getXY(e.iframe).y:0)},200)}catch(d){}this.update();if(e.currentSelectedArr){e.currentSelectedArr=[];b=e.document.getElementsByTagName("td");for(a=0;g=b[a++];)g.className==e.options.selectedTdClass&&e.currentSelectedArr.push(g)}this.clearKey();e.fireEvent("reset",!0)};this.getScene=function(){var b=e.selection.getRange(),g=e.body.innerHTML.replace(j,"");b.shrinkBoundary();browser.ie&&(g=g.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));if(browser.opera||
browser.safari)return{senceRange:new a(b),content:g,bookcontent:g};var f=b.createBookmark(!0,!0),c=e.body.innerHTML.replace(j,"");f&&b.moveToBookmark(f).select(!0);return{bookcontent:c,content:g}};this.save=function(){var b=this.getScene(),a=this.list[this.index];if(!a||!(a.content==b.content&&(browser.opera||browser.safari?a.senceRange.compare(b.senceRange):a.bookcontent==b.bookcontent)))this.list=this.list.slice(0,this.index+1),this.list.push(b),this.list.length>i&&this.list.shift(),this.index=
this.list.length-1,this.clearKey(),this.update()};this.update=function(){this.hasRedo=this.list[this.index+1]?!0:!1;this.hasUndo=this.list[this.index-1]||1==this.list.length?!0:!1};this.reset=function(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=!1;this.clearKey()};this.clearKey=function(){l=0;k=null;e.fireEvent("contentchange")}};e.addListener("beforeexeccommand",b);e.addListener("afterexeccommand",b);e.addListener("reset",function(b,a){a||e.undoManger.reset()});e.commands.redo=e.commands.undo=
{execCommand:function(b){e.undoManger[b]()},queryCommandState:function(b){return e.undoManger["has"+("undo"==b.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var m={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},l=0,k;e.addListener("keydown",function(b,a){e.saveTimer&&(e.saveTimer=window.clearTimeout(e.saveTimer));var f=a.keyCode||a.which;if(!((browser.webkit&&browser.chrome||browser.ie&&10<=browser.version||browser.ie11plus)&&229==f)&&!m[f]&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey)0==e.undoManger.list.length||
(8==f||46==f)&&k!=f?(e.undoManger.save(!0),k=f):(2==e.undoManger.list.length&&(0==e.undoManger.index&&0==l)&&(e.undoManger.list.splice(1,1),e.undoManger.update()),k=f,l++,l>=g&&e.selection.getRange().collapsed&&e.undoManger.save())});if(browser.webkit&&browser.chrome||browser.ie&&10<=browser.version||browser.ie11plus){e.addListener("keyup",function(b,a){e.saveTimer&&(e.saveTimer=window.clearTimeout(e.saveTimer));var g=a.keyCode||a.which;(32==g||13==g)&&e.selection.getRange().collapsed&&n()});var n=
function(){e.saveTimer&&(e.saveTimer=window.clearTimeout(e.saveTimer));e.saveTimer=window.setTimeout(function(){e.undoManger.save()},1E4)}}};(function(){function a(a){var c=this.document;if(!c.getElementById("baidu_pastebin")){var h=this.selection.getRange(),b=h.createBookmark(),e=c.createElement("div");e.id="baidu_pastebin";browser.webkit&&e.appendChild(c.createTextNode(domUtils.fillChar+domUtils.fillChar));c.body.appendChild(e);b.start.style.display="";e.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(b.start).y+"px";h.selectNodeContents(e).select(!0);setTimeout(function(){if(browser.webkit)for(var i=
0,g=c.querySelectorAll("#baidu_pastebin"),j;j=g[i++];)if(domUtils.isEmptyNode(j))domUtils.remove(j);else{e=j;break}try{e.parentNode.removeChild(e)}catch(f){}h.moveToBookmark(b).select(!0);a(e)},0)}}UE.plugins.paste=function(){function d(a){if(a.firstChild){for(var g=domUtils.getElementsByTagName(a,"span"),d=0,f;f=g[d++];)("_baidu_cut_start"==f.id||"_baidu_cut_end"==f.id)&&domUtils.remove(f);if(browser.webkit){f=a.querySelectorAll("div br");for(d=0;g=f[d++];)g=g.parentNode,"DIV"==g.tagName&&1==g.childNodes.length&&
(g.innerHTML="<p><br/></p>",domUtils.remove(g));g=a.querySelectorAll("#baidu_pastebin");for(d=0;f=g[d++];){var m=c.document.createElement("p");for(f.parentNode.insertBefore(m,f);f.firstChild;)m.appendChild(f.firstChild);domUtils.remove(f)}f=a.querySelectorAll("meta");for(d=0;g=f[d++];)domUtils.remove(g);f=a.querySelectorAll("br");for(d=0;g=f[d++];)/^apple-/.test(g)&&domUtils.remove(g)}if(browser.gecko){f=a.querySelectorAll("[_moz_dirty]");for(d=0;g=f[d++];)g.removeAttribute("_moz_dirty")}if(!browser.ie){f=
a.querySelectorAll("span.apple-style-span");for(d=0;g=f[d++];)domUtils.remove(g,!0)}a=a.innerHTML;if(d=c.serialize)try{var l=d.transformInput(d.parseHTML(d.word(a)),h),l=d.filter(l,b?{whiteList:{p:{br:1,BR:1},br:{$:{}},div:{br:1,BR:1,$:{}},li:{$:{}},tr:{td:1,$:{}},td:{$:{}}},blackList:{style:1,script:1,object:1}}:null,!b?e:null);if(browser.webkit)for(var k=l.children.length,n;(n=l.children[k-1])&&"br"==n.tag;)l.children.splice(k-1,1),k=l.children.length;a=d.toHTML(l,b)}catch(t){}a={html:a};c.fireEvent("beforepaste",
a);try{a.html&&(a.html=a.html.replace(/(<img|<img([^\/>]+?))\s+(small)?src\s*=\s*("\s*(?!http).*"|\s*(?!http)[^\s>"]+)(.*?\/?>)/gi,""),c.execCommand("insertHtml",a.html))}catch(q){}c.fireEvent("afterpaste")}}var c=this,h={flag:""},b=c.options.pasteplain,e={flag:""};c.commands.pasteplain={queryCommandState:function(){return b},execCommand:function(){b=!b|0},notNeedUndo:1};c.addListener("ready",function(){domUtils.on(c.body,"cut",function(){!c.selection.getRange().collapsed&&c.undoManger&&c.undoManger.save()});
domUtils.on(c.body,browser.ie?"keydown":"paste",function(b){(!browser.ie||b.ctrlKey&&"86"==b.keyCode)&&a.call(c,function(b){function a(){c.ui.hideToolbarMsg();c.removeListener("selectionchange",a)}d(b);e.flag&&c.ui&&(c.ui.showToolbarMsg(c.options.messages.pasteMsg,h.flag),e.flag="",setTimeout(function(){c.addListener("selectionchange",a)},100));h.flag&&(!c.queryCommandState("pasteplain")&&c.ui)&&(c.ui.showToolbarMsg(c.options.messages.pasteWordImgMsg,!0),h.flag="",setTimeout(function(){c.addListener("selectionchange",
a)},100))})})})}})();UE.plugins.list=function(){function a(a,b,e){var c=a.nextSibling;if(c&&1==c.nodeType&&c.tagName.toLowerCase()==b&&(domUtils.getStyle(c,"list-style-type")||("ol"==b?"decimal":"disc"))==e)domUtils.moveChild(c,a),0==c.childNodes.length&&domUtils.remove(c);(c=a.previousSibling)&&(1==c.nodeType&&c.tagName.toLowerCase()==b&&(domUtils.getStyle(c,"list-style-type")||("ol"==b?"decimal":"disc"))==e)&&domUtils.moveChild(a,c);0==a.childNodes.length&&domUtils.remove(a)}var d=this,c={TD:1,PRE:1,BLOCKQUOTE:1};d.addListener("keydown",
function(a,b){function c(){b.preventDefault?b.preventDefault():b.returnValue=!1;d.undoManger&&d.undoManger.save()}var i=b.keyCode||b.which;if(13==i){var g=d.selection.getRange(),j=domUtils.findParentByTagName(g.startContainer,["ol","ul"],!0,function(b){return b.tagName=="TABLE"}),f=domUtils.findParentByTagName(g.endContainer,["ol","ul"],!0,function(b){return b.tagName=="TABLE"});if(j&&f&&j===f){if(!g.collapsed)if(j=domUtils.findParentByTagName(g.startContainer,"li",!0),f=domUtils.findParentByTagName(g.endContainer,
"li",!0),j&&f&&j===f){if(g.deleteContents(),(f=domUtils.findParentByTagName(g.startContainer,"li",!0))&&domUtils.isEmptyBlock(f)){m=f.previousSibling;i=f.nextSibling;k=d.document.createElement("p");domUtils.fillNode(d.document,k);l=f.parentNode;m&&i?(g.setStart(i,0).collapse(!0).select(!0),domUtils.remove(f)):(!m&&!i||!m?l.parentNode.insertBefore(k,l):f.parentNode.parentNode.insertBefore(k,l.nextSibling),domUtils.remove(f),l.firstChild||domUtils.remove(l),g.setStart(k,0).setCursor());c();return}}else{k=
g.cloneRange();j=k.collapse(!1).createBookmark();g.deleteContents();k.moveToBookmark(j);var f=domUtils.findParentByTagName(k.startContainer,"li",!0),m=f.previousSibling,i=f.nextSibling;m&&(f=m,m.firstChild&&domUtils.isBlockElm(m.firstChild)&&(m=m.firstChild),domUtils.isEmptyNode(m)&&domUtils.remove(f));i&&(f=i,i.firstChild&&domUtils.isBlockElm(i.firstChild)&&(i=i.firstChild),domUtils.isEmptyNode(i)&&domUtils.remove(f));k.select();c();return}if(f=domUtils.findParentByTagName(g.startContainer,"li",
!0)){if(domUtils.isEmptyBlock(f)){var j=g.createBookmark(),l=f.parentNode;f!==l.lastChild?domUtils.breakParent(f,l):(l.parentNode.insertBefore(f,l.nextSibling),domUtils.isEmptyNode(l)&&domUtils.remove(l));if(!dtd.$list[f.parentNode.tagName])if(domUtils.isBlockElm(f.firstChild))domUtils.remove(f,!0);else{k=d.document.createElement("p");for(f.parentNode.insertBefore(k,f);f.firstChild;)k.appendChild(f.firstChild);domUtils.remove(f)}g.moveToBookmark(j).select()}else{k=f.firstChild;if(!k||!domUtils.isBlockElm(k)){var k=
d.document.createElement("p");for(!f.firstChild&&domUtils.fillNode(d.document,k);f.firstChild;)k.appendChild(f.firstChild);f.appendChild(k)}j=d.document.createElement("span");g.insertNode(j);domUtils.breakParent(j,f);m=j.nextSibling;k=m.firstChild;k||(k=d.document.createElement("p"),domUtils.fillNode(d.document,k),m.appendChild(k));domUtils.isEmptyNode(k)&&(k.innerHTML="",domUtils.fillNode(d.document,k));g.setStart(k,0).collapse(!0).shrinkBoundary().select();domUtils.remove(j);if((m=m.previousSibling)&&
domUtils.isEmptyBlock(m))m.innerHTML="<p></p>",domUtils.fillNode(d.document,m.firstChild)}c()}}}if(8==i&&(g=d.selection.getRange(),g.collapsed&&domUtils.isStartInblock(g)&&(k=g.cloneRange().trimBoundary(),(f=domUtils.findParentByTagName(g.startContainer,"li",!0))&&domUtils.isStartInblock(k))))if(f&&(m=f.previousSibling)){if(!(46==i&&f.childNodes.length)){dtd.$list[m.tagName]&&(m=m.lastChild);d.undoManger&&d.undoManger.save();k=f.firstChild;if(domUtils.isBlockElm(k))if(domUtils.isEmptyNode(k)){m.appendChild(k);
for(g.setStart(k,0).setCursor(!1,!0);f.firstChild;)m.appendChild(f.firstChild)}else{if((j=domUtils.findParentByTagName(g.startContainer,"p",!0))&&j!==k)return;j=d.document.createElement("span");g.insertNode(j);domUtils.moveChild(f,m);g.setStartBefore(j).collapse(!0).select(!0);domUtils.remove(j)}else if(domUtils.isEmptyNode(f))k=d.document.createElement("p"),m.appendChild(k),g.setStart(k,0).setCursor();else for(g.setEnd(m,m.childNodes.length).collapse().select(!0);f.firstChild;)m.appendChild(f.firstChild);
domUtils.remove(f);d.undoManger&&d.undoManger.save();domUtils.preventDefault(b)}}else if(f&&!f.previousSibling&&(k=f.firstChild,!k||f.lastChild===k&&domUtils.isEmptyNode(domUtils.isBlockElm(k)?k:f)))k=d.document.createElement("p"),f.parentNode.parentNode.insertBefore(k,f.parentNode),domUtils.fillNode(d.document,k),g.setStart(k,0).setCursor(),domUtils.remove(!f.nextSibling?f.parentNode:f),d.undoManger&&d.undoManger.save(),domUtils.preventDefault(b)});d.commands.insertorderedlist=d.commands.insertunorderedlist=
{execCommand:function(d,b){b||(b="insertorderedlist"==d.toLowerCase()?"decimal":"disc");var e=this.selection.getRange(),i=function(b){return 1==b.nodeType?"br"!=b.tagName.toLowerCase():!domUtils.isWhitespace(b)},g="insertorderedlist"==d.toLowerCase()?"ol":"ul",j=this.document.createDocumentFragment();e.adjustmentBoundary().shrinkBoundary();var f=e.createBookmark(!0),m=domUtils.findParentByTagName(this.document.getElementById(f.start),"li"),l=0,k=domUtils.findParentByTagName(this.document.getElementById(f.end),
"li"),n=0,t,q,o,s;if(m||k){m&&(t=m.parentNode);f.end||(k=m);k&&(q=k.parentNode);if(t===q){for(;m!==k;){s=m;m=m.nextSibling;if(!domUtils.isBlockElm(s.firstChild)){for(i=this.document.createElement("p");s.firstChild;)i.appendChild(s.firstChild);s.appendChild(i)}j.appendChild(s)}s=this.document.createElement("span");t.insertBefore(s,k);if(!domUtils.isBlockElm(k.firstChild)){for(i=this.document.createElement("p");k.firstChild;)i.appendChild(k.firstChild);k.appendChild(i)}j.appendChild(k);domUtils.breakParent(s,
t);domUtils.isEmptyNode(s.previousSibling)&&domUtils.remove(s.previousSibling);domUtils.isEmptyNode(s.nextSibling)&&domUtils.remove(s.nextSibling);i=domUtils.getComputedStyle(t,"list-style-type")||("insertorderedlist"==d.toLowerCase()?"decimal":"disc");if(t.tagName.toLowerCase()==g&&i==b){i=0;for(m=this.document.createDocumentFragment();t=j.childNodes[i++];)for(;t.firstChild;)m.appendChild(t.firstChild);s.parentNode.insertBefore(m,s)}else o=this.document.createElement(g),domUtils.setStyle(o,"list-style-type",
b),o.appendChild(j),s.parentNode.insertBefore(o,s);domUtils.remove(s);o&&a(o,g,b);e.moveToBookmark(f).select();return}if(m){for(;m;){s=m.nextSibling;o=this.document.createDocumentFragment();for(var r=0;m.firstChild;)domUtils.isBlockElm(m.firstChild)&&(r=1),o.appendChild(m.firstChild);r?j.appendChild(o):(r=this.document.createElement("p"),r.appendChild(o),j.appendChild(r));domUtils.remove(m);m=s}t.parentNode.insertBefore(j,t.nextSibling);domUtils.isEmptyNode(t)?(e.setStartBefore(t),domUtils.remove(t)):
e.setStartAfter(t);l=1}if(k){for(m=q.firstChild;m!==k;){s=m.nextSibling;o=this.document.createDocumentFragment();for(r=0;m.firstChild;)domUtils.isBlockElm(m.firstChild)&&(r=1),o.appendChild(m.firstChild);r?j.appendChild(o):(r=this.document.createElement("p"),r.appendChild(o),j.appendChild(r));domUtils.remove(m);m=s}j.appendChild(k.firstChild);domUtils.remove(k);q.parentNode.insertBefore(j,q);e.setEndBefore(q);domUtils.isEmptyNode(q)&&domUtils.remove(q);n=1}}l||e.setStartBefore(this.document.getElementById(f.start));
f.end&&!n&&e.setEndAfter(this.document.getElementById(f.end));e.enlarge(!0,function(b){return c[b.tagName]});j=this.document.createDocumentFragment();t=e.createBookmark();o=domUtils.getNextDomNode(t.start,!1,i);m=e.cloneRange();for(k=domUtils.isBlockElm;o&&o!==t.end&&domUtils.getPosition(o,t.end)&domUtils.POSITION_PRECEDING;)if(3==o.nodeType||dtd.li[o.tagName])if(1==o.nodeType&&dtd.$list[o.tagName]){for(;o.firstChild;)j.appendChild(o.firstChild);l=domUtils.getNextDomNode(o,!1,i);domUtils.remove(o);
o=l}else{l=o;for(m.setStartBefore(o);o&&o!==t.end&&(!k(o)||domUtils.isBookmarkNode(o));)l=o,o=domUtils.getNextDomNode(o,!1,null,function(b){return!c[b.tagName]});if(o&&k(o)&&(s=domUtils.getNextDomNode(l,!1,i))&&domUtils.isBookmarkNode(s))o=domUtils.getNextDomNode(s,!1,i),l=s;m.setEndAfter(l);o=domUtils.getNextDomNode(l,!1,i);s=e.document.createElement("li");s.appendChild(m.extractContents());j.appendChild(s)}else o=domUtils.getNextDomNode(o,!0,i);e.moveToBookmark(t).collapse(!0);o=this.document.createElement(g);
domUtils.setStyle(o,"list-style-type",b);o.appendChild(j);e.insertNode(o);a(o,g,b);e.moveToBookmark(f).select()},queryCommandState:function(a){return this.highlight?-1:utils.findNode(this.selection.getStartElementPath(),["insertorderedlist"==a.toLowerCase()?"ol":"ul"])?1:0},queryCommandValue:function(a){return(a=utils.findNode(this.selection.getStartElementPath(),["insertorderedlist"==a.toLowerCase()?"ol":"ul"]))?domUtils.getComputedStyle(a,"list-style-type"):null}}};(function(){function a(b){b=b||{};this.indentChar="";this.breakChar=b.breakChar||"\n";this.selfClosingEnd=b.selfClosingEnd||" />"}var d=function(){function b(b){return a[b]}var a={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(a){return(a+="")?a.replace(/[<>"']/g,b):""}}(),c=utils.extend({a:1,A:1},dtd.$inline,!0);a.prototype={format:function(b){b=UE.serialize.parseHTML(b);this.buff=[];this.indents="";this.indenting=1;this.visitNode(b);return this.buff.join("")},visitNode:function(b){if("fragment"==
b.type)this.visitChildren(b.children);else if("element"==b.type){var a=dtd.$empty[b.tag];this.visitTag(b.tag,b.attributes,a);this.visitChildren(b.children);a||this.visitEndTag(b.tag)}else"comment"==b.type?this.visitComment(b.data):this.visitText(b.data,dtd.$notTransContent[b.parent.tag])},visitChildren:function(b){for(var a=0;a<b.length;a++)this.visitNode(b[a])},visitTag:function(b,a,i){this.indenting?this.indent():c[b]||(this.newline(),this.indent());this.buff.push("<",b);var g=[],j;for(j in a)g.push(j+
'="'+d(a[j])+'"');(a=g.join(" "))&&this.buff.push(" ",a);i?(this.buff.push(this.selfClosingEnd),"br"==b&&this.newline()):(this.buff.push(">"),this.indents+=this.indentChar);c[b]||this.newline()},indent:function(){this.buff.push(this.indents);this.indenting=0},newline:function(){this.buff.push(this.breakChar);this.indenting=1},visitEndTag:function(b){this.indents=this.indents.slice(0,-this.indentChar.length);this.indenting?this.indent():c[b]||(this.newline(),this.indent());this.buff.push("</",b,">")},
visitText:function(b){this.indenting&&this.indent();b=b.replace(/&nbsp;/g," ");this.buff.push(b)},visitComment:function(b){this.indenting&&this.indent();this.buff.push("<\!--",b,"--\>")}};var h={textarea:function(b,a){var c=a.ownerDocument.createElement("textarea");c.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";browser.ie&&8>browser.version&&(c.style.width=a.offsetWidth+"px",c.style.height=a.offsetHeight+"px",a.onresize=function(){c.style.width=
a.offsetWidth+"px";c.style.height=a.offsetHeight+"px"});a.appendChild(c);return{setContent:function(a){c.value=a},getContent:function(){return c.value},select:function(){var a;if(browser.ie){a=c.createTextRange();a.collapse(true);a.select()}else{c.setSelectionRange(0,0);c.focus()}},dispose:function(){a.removeChild(c);a=c=a.onresize=null}}},codemirror:function(a,c){var d=window.CodeMirror(c,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),g=d.getWrapperElement();g.style.cssText=
'position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';d.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";d.refresh();return{setContent:function(a){d.setValue(a)},getContent:function(){return d.getValue()},select:function(){d.focus()},dispose:function(){c.removeChild(g);d=g=null}}}};UE.plugins.source=function(){function b(a){var a=a.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>",a=a.replace(/>[\n\r\t]+/g,
">").replace(/[\n\r\t]+</g,"<").replace(/>[\n\r\t]+</g,"><"),b=/(<img|<img([^\/>]+?))\s+(small)?src\s*=\s*("\s*(?!http).*"|\s*(?!http)[^\s>"]+)(.*?\/?>)/gi;try{a=a.replace(b,"")}catch(c){}return a=a.replace(/<p>([ ])+<\/p>/gi,function(a){return a.replace(/[ ]/gi,"&nbsp;")})}var c=this,d=this.options,g=new a(d.source),j=!1,f,m;c.commands.source={execCommand:function(){if(j=!j){c.undoManger&&c.undoManger.save();this.currentSelectedArr&&domUtils.clearSelectedArr(this.currentSelectedArr);browser.gecko&&
(c.body.contentEditable=!1);m=c.iframe.style.cssText;c.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var a=g.format(c.hasContents()?c.getContent():"");f=h["codemirror"==d.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](c,c.iframe.parentNode);f.setContent(a);setTimeout(function(){f.select()})}else{c.iframe.style.cssText=m;a=b(f);if(/<embed/.test(a)){c.setContent(a);for(var l=!1,k=c.document.getElementsByTagName("embed")||[],o=0;o<k.length;o++)"transparent"!=k[o].getAttribute("wmode")&&
(l=!0,k[o].setAttribute("wmode","transparent"));l&&(a=g.format(c.hasContents()?c.getContent():""),f.setContent(a),a=b(f))}c.setContent(a);f.dispose();f=null;setTimeout(function(){var a=c.body.firstChild;a||(c.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",a=c.body.firstChild);for(c.undoManger&&c.undoManger.save();a&&a.firstChild;)a=a.firstChild;var b=c.selection.getRange();3==a.nodeType||dtd.$empty[a.tagName]?b.setStartBefore(a):b.setStart(a,0);if(browser.gecko){var g=document.createElement("input");
g.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(g);c.body.contentEditable=!1;setTimeout(function(){domUtils.setViewportOffset(g,{left:-32768,top:0});g.focus();setTimeout(function(){c.body.contentEditable=true;b.setCursor(false,true);domUtils.remove(g)})})}else b.setCursor(!1,!0)})}this.fireEvent("sourcemodechanged",j)},queryCommandState:function(){return j|0}};var l=c.queryCommandState;c.queryCommandState=function(a){a=a.toLowerCase();return j?"source"==a?1:-1:l.apply(this,
arguments)};var k=c.getContent;c.getContent=function(){if(j&&f){var a=f.getContent(),a=this.document.body.innerHTML.replace(RegExp(domUtils.fillChar,"g"),"").replace(/>[\t\r\n]*?</g,"><");this.serialize&&(a=this.serialize.parseHTML(a),a=this.serialize.filter(a),a=this.serialize.toHTML(a));return a}return k.apply(this,arguments)};c.addListener("ready",function(){"codemirror"==d.sourceEditor&&(utils.loadFile(document,{src:d.codeMirrorJsUrl,tag:"script",type:"text/javascript",defer:"defer"}),utils.loadFile(document,
{tag:"link",rel:"stylesheet",type:"text/css",href:d.codeMirrorCssUrl}))})}})();UE.plugins.enterkey=function(){var a,d=this,c=d.options.enterTag;d.addListener("keyup",function(c,b){if(13==(b.keyCode||b.which)){var e=d.selection.getRange(),i=e.startContainer,g;if(!browser.ie&&/h\d/i.test(a)){if(browser.gecko)domUtils.findParentByTagName(i,"h1 h2 h3 h4 h5 h6 blockquote".split(" "),!0)||(d.document.execCommand("formatBlock",!1,"<p>"),g=1);else if(1==i.nodeType){var i=d.document.createTextNode(""),j;e.insertNode(i);if(j=domUtils.findParentByTagName(i,"div",!0)){for(g=d.document.createElement("p");j.firstChild;)g.appendChild(j.firstChild);
j.parentNode.insertBefore(g,j);domUtils.remove(j);e.setStartBefore(i).setCursor();g=1}domUtils.remove(i)}d.undoManger&&g&&d.undoManger.save()}setTimeout(function(){d.selection.getRange().scrollToView(d.autoHeightEnabled,d.autoHeightEnabled?domUtils.getXY(d.iframe).y:0)},50)}});d.addListener("keydown",function(h,b){if(13==(b.keyCode||b.which)){d.undoManger&&d.undoManger.save();a="";var e=d.selection.getRange();if(!e.collapsed){var i=e.startContainer,g=e.endContainer,i=domUtils.findParentByTagName(i,
"td",!0),g=domUtils.findParentByTagName(g,"td",!0);if(i&&g&&i!==g||!i&&g||i&&!g){b.preventDefault?b.preventDefault():b.returnValue=!1;return}}d.currentSelectedArr&&domUtils.clearSelectedArr(d.currentSelectedArr);if("p"==c)browser.ie||((i=domUtils.findParentByTagName(e.startContainer,"ol ul p h1 h2 h3 h4 h5 h6 blockquote".split(" "),!0))?(a=i.tagName,"p"==i.tagName.toLowerCase()&&browser.gecko&&domUtils.removeDirtyAttr(i)):(d.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(e=d.selection.getRange(),
(i=domUtils.findParentByTagName(e.startContainer,"p",!0))&&domUtils.removeDirtyAttr(i))));else if(b.preventDefault?b.preventDefault():b.returnValue=!1,e.collapsed)g=e.document.createElement("br"),e.insertNode(g),g.parentNode.lastChild===g?(g.parentNode.insertBefore(g.cloneNode(!0),g),e.setStartBefore(g)):e.setStartAfter(g),e.setCursor();else if(e.deleteContents(),i=e.startContainer,1==i.nodeType&&(i=i.childNodes[e.startOffset])){for(;1==i.nodeType;){if(dtd.$empty[i.tagName])return e.setStartBefore(i).setCursor(),
d.undoManger&&d.undoManger.save(),!1;if(!i.firstChild)return g=e.document.createElement("br"),i.appendChild(g),e.setStart(i,0).setCursor(),d.undoManger&&d.undoManger.save(),!1;i=i.firstChild}i===e.startContainer.childNodes[e.startOffset]?(g=e.document.createElement("br"),e.insertNode(g).setCursor()):e.setStart(i,0).setCursor()}else g=e.document.createElement("br"),e.insertNode(g).setStartAfter(g).setCursor()}})};UE.plugins.keystrokes=function(){var a=this,d=0,c=domUtils.keys,h={B:"strong",I:"em",FONT:"span"},b=[0,10,12,16,18,24,32,48],e={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};a.addListener("keydown",function(b,c){var j,f,h=c.keyCode||c.which;if(this.selectAll&&(this.selectAll=!1,8==h||46==h)){a.undoManger&&a.undoManger.save();a.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";(new dom.Range(a.document)).setStart(a.body.firstChild,0).setCursor(!1,
!0);a.undoManger&&a.undoManger.save();browser.ie&&a._selectionChange();domUtils.preventDefault(c);return}if(8==h){var l=a.selection.getRange(),k,n;if(l.collapsed&&(n=l.startContainer,domUtils.isWhitespace(n)&&(n=n.parentNode),domUtils.isEmptyNode(n)&&n===a.body.firstChild)){"P"!=n.tagName&&(p=a.document.createElement("p"),a.body.insertBefore(p,n),domUtils.fillNode(a.document,p),l.setStart(p,0).setCursor(!1,!0),domUtils.remove(n));domUtils.preventDefault(c);return}l.collapsed&&(3==l.startContainer.nodeType&&
0==l.startContainer.nodeValue.replace(RegExp(domUtils.fillChar,"g"),"").length)&&l.setStartBefore(l.startContainer).collapse(!0);if(n=l.getClosedNode()){a.undoManger&&a.undoManger.save();l.setStartBefore(n);domUtils.remove(n);l.setCursor();a.undoManger&&a.undoManger.save();domUtils.preventDefault(c);return}if(!browser.ie){n=domUtils.findParentByTagName(l.startContainer,"table",!0);k=domUtils.findParentByTagName(l.endContainer,"table",!0);if(n&&!k||!n&&k||n!==k){c.preventDefault();return}if(browser.webkit&&
(l.collapsed&&n)&&(k=l.cloneRange().txtToElmBoundary(),n=k.startContainer,domUtils.isBlockElm(n)&&1==n.nodeType&&!dtd.$tableContent[n.tagName]&&!domUtils.getChildCount(n,function(a){return 1==a.nodeType?"BR"!==a.tagName:1}))){k.setStartBefore(n).setCursor();domUtils.remove(n,!0);c.preventDefault();return}}a.undoManger&&!l.collapsed&&(a.undoManger.save(),d=1)}if(9==h){l=a.selection.getRange();a.undoManger&&a.undoManger.save();k=0;for(n="";k<a.options.tabSize;k++)n+=a.options.tabNode;f=a.document.createElement("span");
f.innerHTML=n;if(l.collapsed)l.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);else{n=domUtils.findParentByTagName(l.startContainer,"table",!0);k=domUtils.findParentByTagName(l.endContainer,"table",!0);if(n||k){c.preventDefault?c.preventDefault():c.returnValue=!1;return}n=domUtils.findParentByTagName(l.startContainer,["ol","ul"],!0);k=domUtils.findParentByTagName(l.endContainer,["ol","ul"],!0);if(n&&k&&n===k){var t=l.createBookmark();n=domUtils.findParentByTagName(l.startContainer,"li",!0);k=
domUtils.findParentByTagName(l.endContainer,"li",!0);if(n===n.parentNode.firstChild)k=a.document.createElement(n.parentNode.tagName),n.parentNode.parentNode.insertBefore(k,n.parentNode),k.appendChild(n.parentNode);else{j=n.parentNode;f=a.document.createElement(j.tagName);j=utils.indexOf(e[f.tagName],domUtils.getComputedStyle(j,"list-style-type"));j=j+1==e[f.tagName].length?0:j+1;domUtils.setStyle(f,"list-style-type",e[f.tagName][j]);for(n.parentNode.insertBefore(f,n);n!==k;)j=n.nextSibling,f.appendChild(n),
n=j;f.appendChild(k)}l.moveToBookmark(t).select()}else{if(n||k){c.preventDefault?c.preventDefault():c.returnValue=!1;return}n=domUtils.findParent(l.startContainer,t);k=domUtils.findParent(l.endContainer,t);if(n&&k&&n===k)l.deleteContents(),l.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);else{n=l.createBookmark();t=function(a){return domUtils.isBlockElm(a)};l.enlarge(!0);k=l.createBookmark();for(j=domUtils.getNextDomNode(k.start,!1,t);j&&!(domUtils.getPosition(j,k.end)&domUtils.POSITION_FOLLOWING);)j.insertBefore(f.cloneNode(!0).firstChild,
j.firstChild),j=domUtils.getNextDomNode(j,!1,t);l.moveToBookmark(k).moveToBookmark(n).select()}}}a.undoManger&&a.undoManger.save();c.preventDefault?c.preventDefault():c.returnValue=!1}if(browser.gecko&&46==h&&(l=a.selection.getRange(),l.collapsed&&(n=l.startContainer,domUtils.isEmptyBlock(n)))){for(h=n.parentNode;1==domUtils.getChildCount(h)&&!domUtils.isBody(h);)n=h,h=h.parentNode;n===h.lastChild&&c.preventDefault()}});a.addListener("keyup",function(e,g){var j=g.keyCode||g.which;if(!browser.gecko&&
(!c[j]&&!g.ctrlKey&&!g.metaKey&&!g.shiftKey&&!g.altKey)&&(k=a.selection.getRange(),k.collapsed)){for(var f=k.startContainer,m=0;!domUtils.isBlockElm(f);){if(1==f.nodeType&&-1!=utils.indexOf(["FONT","B","I"],f.tagName)){var l=a.document.createElement(h[f.tagName]);"FONT"==f.tagName&&(l.style.cssText=(f.getAttribute("size")?"font-size:"+(b[f.getAttribute("size")]||12)+"px":"")+";"+(f.getAttribute("color")?"color:"+f.getAttribute("color"):"")+";"+(f.getAttribute("face")?"font-family:"+f.getAttribute("face"):
"")+";"+f.style.cssText);for(;f.firstChild;)l.appendChild(f.firstChild);f.parentNode.insertBefore(l,f);domUtils.remove(f);m||k.setEnd(l,l.childNodes.length).collapse(!0);f=l;m=1}f=f.parentNode}m&&k.select()}if(8==j){if(browser.gecko){k=0;for(j=domUtils.getElementsByTagName(this.body,"li");f=j[k++];)domUtils.isEmptyNode(f)&&!f.previousSibling&&(m=f.parentNode,domUtils.remove(f),domUtils.isEmptyNode(m)&&domUtils.remove(m))}var k;if((f=this.currentSelectedArr)&&0<f.length){for(k=0;j=f[k++];)j.innerHTML=
browser.ie?9>browser.version?"&#65279":"":"<br/>";k=new dom.Range(this.document);k.setStart(f[0],0).setCursor();d&&(a.undoManger.save(),d=0);browser.webkit&&g.preventDefault()}else{k=a.selection.getRange();f=k.startContainer;domUtils.isWhitespace(f)&&(f=f.parentNode);for(m=0;1==f.nodeType&&domUtils.isEmptyNode(f)&&dtd.$removeEmpty[f.tagName];)m=1,j=f.parentNode,domUtils.remove(f),f=j;if(m&&1==f.nodeType&&domUtils.isEmptyNode(f)){if(browser.ie){var n=k.document.createElement("span");f.appendChild(n);
k.setStart(f,0).setCursor();if(f=domUtils.findParentByTagName(f,"li",!0))for(k=f.nextSibling;k;)if(domUtils.isEmptyBlock(k))f=k,k=k.nextSibling,domUtils.remove(f);else break}else f.innerHTML="<br/>",k.setStart(f,0).setCursor(!1,!0);setTimeout(function(){browser.ie&&domUtils.remove(n);if(d){a.undoManger.save();d=0}},0)}else d&&(a.undoManger.save(),d=0)}}})};UE.plugins.autoheight=function(){function a(){clearTimeout(g);g=setTimeout(function(){1!=d.queryCommandState("source")&&(h||(h=d.document.createElement("span"),h.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",h.innerHTML="."),b=h.cloneNode(!0),d.body.appendChild(b),i=Math.max(domUtils.getXY(b).y+b.offsetHeight,d.options.minFrameHeight),i!=e&&(d.setHeight(i),e=i),domUtils.remove(b))},50)}var d=this;d.autoHeightEnabled=d.options.autoHeightEnabled;if(d.autoHeightEnabled){var c,
h,b,e=0,i,g;d.addListener("destroy",function(){d.removeListener("contentchange",a);d.removeListener("keyup",a);d.removeListener("mouseup",a)});d.enableAutoHeight=function(){if(d.autoHeightEnabled){var b=d.document;d.autoHeightEnabled=!0;c=b.body.style.overflowY;b.body.style.overflowY="hidden";d.addListener("contentchange",a);d.addListener("keyup",a);d.addListener("mouseup",a);setTimeout(function(){a()},browser.gecko?100:0);d.fireEvent("autoheightchanged",d.autoHeightEnabled)}};d.disableAutoHeight=
function(){d.body.style.overflowY=c||"";d.removeListener("contentchange",a);d.removeListener("keyup",a);d.removeListener("mouseup",a);d.autoHeightEnabled=!1;d.fireEvent("autoheightchanged",d.autoHeightEnabled)};d.addListener("ready",function(){d.enableAutoHeight();var b;domUtils.on(browser.ie?d.body:d.document,browser.webkit?"dragover":"drop",function(){clearTimeout(b);b=setTimeout(function(){a()},100)})})}};UE.plugins.serialize=function(){function a(a){return/pt/.test(a)?a.replace(/([\d.]+)pt/g,function(a){return Math.round(96*parseFloat(a)/72)+"px"}):a}function d(a){var b;a&&"p"==a.tag&&("MsoListParagraph"==a.attributes["class"]||/mso-list/.test(a.attributes.style)?b=1:(a=a.children[0])&&("span"==a.tag&&/Wingdings/i.test(a.attributes.style))&&(b=1));return b}function c(a,b){if("element"==a.type&&!a.children.length&&dtd.$removeEmpty[a.tag]&&"a"!=a.tag)return{type:"fragment",children:[]};var c=[0,10,
12,16,18,24,32,48],g;g=utils.indexOf;switch(a.tag){case "img":if(a.attributes.src&&/^data:/.test(a.attributes.src))return{type:"fragment",children:[]};if(a.attributes.src&&/^(?:file)/.test(a.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(a.attributes.src))return{type:"fragment",children:[]};a.attributes.word_img=a.attributes.src;a.attributes.src=j.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";c=128>parseInt(a.attributes.width)||43>parseInt(a.attributes.height);a.attributes.style=
"background:url("+j.options.UEDITOR_HOME_URL+"themes/default/images/"+(c?"word.gif":"localimage.png")+") no-repeat center center;border:1px solid #ddd";b&&(b.flag=1)}browser.ie&&(7>browser.version&&j.options.relativePath)&&(a.attributes.orgSrc=a.attributes.src);a.attributes.data_ue_src=a.attributes.data_ue_src||a.attributes.src;break;case "li":c=a.children[0];if(!c||"element"!=c.type||"p"!=c.tag&&dtd.p[c.tag])g={type:"element",tag:"p",attributes:{},parent:a},g.children=c?a.children:[browser.ie?{type:"text",
data:domUtils.fillChar,parent:g}:{type:"element",tag:"br",attributes:{},closed:!0,children:[],parent:g}],a.children=[g];break;case "table":case "td":h(a);break;case "a":a.attributes.anchorname&&(a.tag="img",a.attributes={"class":"anchorclass",anchorname:a.attributes.name},a.closed=1);a.attributes.href&&(a.attributes.data_ue_src=a.attributes.href);break;case "b":a.tag=a.name="strong";break;case "i":a.tag=a.name="em";break;case "u":a.tag=a.name="span";a.attributes.style=(a.attributes.style||"")+";text-decoration:underline;";
break;case "s":case "del":a.tag=a.name="span";a.attributes.style=(a.attributes.style||"")+";text-decoration:line-through;";1==a.children.length&&(c=a.children[0],c.tag==a.tag&&(a.attributes.style+=";"+c.attributes.style,a.children=c.children));break;case "span":if(/mso-list/.test(a.attributes.style)){if("end"!=v){for(var c=a.children[0],f;"element"==c.type;)c=c.children[0];for(f in s)if(s[f].test(c.data)){r="ul";u=f;break}if(!r)for(f in o)if(o[f].test(c.data.replace(/\.$/,""))){r="ol";u=f;break}v?
(c.data==v?("ul"!=r&&(u=""),r="ul"):("ol"!=r&&(u=""),r="ol"),v="end"):v=c.data;if(r){for(c=a;c&&"ul"!=c.tag&&"ol"!=c.tag;)c=c.parent;c&&(c.tag=r,c.attributes.style="list-style-type:"+u)}}a={type:"fragment",children:[]};break}if(c=a.attributes.style)if(c=c.match(/(?:\b(?:color|font-size|background(-color)?|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi))a.attributes.style=c.join(";"),a.attributes.style||delete a.attributes.style;browser.gecko&&(10902>=browser.version&&a.parent)&&(c=
a.parent,"span"==c.tag&&(c.attributes&&c.attributes.style)&&(a.attributes.style=c.attributes.style+";"+a.attributes.style));utils.isEmptyObject(a.attributes)&&(a.type="fragment");break;case "font":a.tag=a.name="span";g=a.attributes;for(a.attributes={style:(g.size?"font-size:"+(c[g.size]||12)+"px":"")+";"+(g.color?"color:"+g.color:"")+";"+(g.face?"font-family:"+g.face:"")+";"+(g.style||"")};a.parent.tag==a.tag&&1==a.parent.children.length;)a.attributes.style&&(a.parent.attributes.style?a.parent.attributes.style+=
";"+a.attributes.style:a.parent.attributes.style=a.attributes.style),a.parent.children=a.children,a=a.parent;break;case "p":if(a.attributes.align&&(a.attributes.style=(a.attributes.style||"")+";text-align:"+a.attributes.align+";",delete a.attributes.align),d(a)){if(!q){c={type:"element",tag:"ul",attributes:{},children:[]};g=g(a.parent.children,a);a.parent.children[g]=c;c.parent=a.parent;c.children[0]=a;for(a.parent=c;;)if(a=c.parent.children[g+1],d(a))c.children[c.children.length]=a,a.parent=c,c.parent.children.splice(g+
1,1);else break;return c}a.tag=a.name="li";if(browser.webkit){for(c=a.children[0];c&&"element"==c.type;)c=c.children[0];c&&(c.parent.attributes.style=(c.parent.attributes.style||"")+";mso-list:10")}delete a.attributes["class"];delete a.attributes.style}}return a}function h(a){i&&a.attributes.style&&(a.attributes.style=a.attributes.style.replace(/;\s*/g,";"),a.attributes.style=a.attributes.style.replace(/^\s*|\s*$/,""))}function b(a,b,c){if(!a.children||!a.children.length)return a;for(var g=a.children,
f=0;f<g.length;f++){var d=b(g[f],c);if("fragment"==d.type){var e=[f,1];e.push.apply(e,d.children);g.splice.apply(g,e);g.length||(a={type:"fragment",children:[]});f--}else g[f]=d}return a}function e(a){this.rules=a}var i=browser.ie,g=browser.version,j=this,f=dtd.$empty,m=function(){function a(f,j){var h,m=0,l,k;for(b.exec("");h=b.exec(f);){l=h.index;if(l>m)if(m=f.slice(m,l),k)k.push(m);else if(!("li"==h[3]||"</ol>"==h[0]||"</ul>"==h[0])&&("<p>"!=h[0]||utils.trim(m)))j.onText(m);m=b.lastIndex;if(l=
h[1])if(l=l.toLowerCase(),k&&l==k._tag_name&&(j.onCDATA(k.join("")),k=null),!k){j.onTagClose(l);continue}if(k)k.push(h[0]);else if(l=h[3]){if(!/="/.test(l)){l=l.toLowerCase();h=h[4];var n,s={},r=h&&"/"==h.slice(-1);if(h)for(c.exec("");n=c.exec(h);){var t=n[1].toLowerCase();n=n[2]||n[3]||n[4]||"";!n&&d[t]&&(n=t);"style"==t&&i&&6>=g&&(n=n.replace(/(?!;)\s*([\w-]+):/g,function(a,b){return b.toLowerCase()+":"}));n&&(s[t]=n.replace(/:\s*/g,":"))}j.onTagOpen(l,s,r);!k&&e[l]&&(k=[],k._tag_name=l)}}else if(l=
h[2])j.onComment(l)}if(f.length>m)j.onText(f.slice(m,f.length))}var b=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\>)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,c=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,d={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},e={script:1,style:1},j={li:{$:"ul",ul:1,ol:1},dd:{$:"dl",dl:1},dt:{$:"dl",dl:1},option:{$:"select",select:1},
td:{$:"tr",tr:1},th:{$:"tr",tr:1},tr:{$:"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{$:"table",table:1,colgroup:1},thead:{$:"table",table:1},tfoot:{$:"table",table:1},col:{$:"colgroup",colgroup:1}},h={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};return function(b,c){function g(a){a.parent=m;m.children.push(a)}function d(a,b){var g=a;if(j[g.tag]){for(;j[m.tag]&&j[m.tag][g.tag];)m=m.parent;m.tag==g.tag&&(m=m.parent);for(;j[g.tag]&&!j[g.tag][m.tag];)g=
g.parent={type:"element",tag:j[g.tag].$,attributes:{},children:[g]}}if(c)for(;dtd[g.tag]&&!("span"==m.tag?utils.extend(dtd.strong,{a:1,A:1}):dtd[m.tag]||dtd.div)[g.tag];)if(!e(m)){if(!m.parent)break;m=m.parent}g.parent=m;m.children.push(g);b&&(m=a);a.attributes.style&&(!a.attributes.webvideo&&!a.attributes.localvideo)&&(a.attributes.style=a.attributes.style.toLowerCase());return a}function e(a){var b;return!a.children.length&&(b=h[a.tag])?(d({type:"element",tag:b,attributes:{},children:[]},!0),!0):
!1}var i={type:"fragment",parent:null,children:[]},m=i;for(a(b,{onText:function(a){for(;!(dtd[m.tag]||dtd.div)["#"];)e(m)||(m=m.parent);g({type:"text",data:a})},onComment:function(a){g({type:"comment",data:a})},onCDATA:function(a){for(;!(dtd[m.tag]||dtd.div)["#"];)e(m)||(m=m.parent);g({type:"cdata",data:a})},onTagOpen:function(a,b,c){c=c||f[a];d({type:"element",tag:a,attributes:b,closed:c,children:[]},!c)},onTagClose:function(a){for(var b=m;b&&a!=b.tag;)b=b.parent;if(b){for(a=m;a!==b.parent;a=a.parent)e(a);
m=b.parent}else if(!dtd.$removeEmpty[a]&&!(dtd.$removeEmptyBlock[a]||"embed"==a))b={type:"element",tag:a,attributes:{},children:[]},d(b,!0),e(b),m=b.parent}});m!==i;)e(m),m=m.parent;return i}}(),l=function(){function a(c){return b[c]}var b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(b){return(b+="")?b.replace(/[<>"']/g,a):""}}(),k=function(){function b(a,c){for(var g=a.children,f=[],d=0,e;e=g[d];d++)f.push(k(e,c));return f.join("")}function c(b){var g=[],f;for(f in b){var d=b[f];
"style"==f&&(d=a(d),/rgba?\s*\([^)]*\)/.test(d)&&(d=d.replace(/rgba?\s*\(([^)]*)\)/g,function(a){return utils.fixColor("color",a)})),b[f]=utils.optCss(d.replace(/windowtext/g,"#000")));g.push(f+'="'+l(b[f])+'"')}return g.join(" ")}var g={div:"p",li:"p",tr:"p",br:"br",p:"p"};return function(a,d){if("fragment"==a.type)return b(a,d);if("element"==a.type){var e=a.tag;if(d&&"td"==e)j||(j=""),j+=b(a,d)+"&nbsp;&nbsp;&nbsp;";else{var j=c(a.attributes),j="<"+(d&&g[e]?g[e]:e)+(j?" "+j:"")+(f[e]?" />":">");
f[e]||(browser.ie&&("p"==e&&!a.children.length)&&(j+="&nbsp;"),j+=b(a,d),j+="</"+(d&&g[e]?g[e]:e)+">")}return j}return"text"==a.type||"cdata"==a.type?dtd.$notTransContent[a.parent.tag]?a.data.replace(/&nbsp;/g," "):l(a.data).replace(/ /g,"&nbsp;"):"comment"==a.type?"<\!--"+a.data+"--\>":""}}(),n=function(){function b(a){return a=a.replace(/([\d.]+)([\w]+)?/g,function(a,b,c){return(Math.round(parseFloat(b))||1)+(c||"px")})}function c(g){g=g.replace(/<\!--\s*EndFragment\s*--\>[\s\S]*$/,"").replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,
"").replace(/^\s*(&nbsp;)+/ig,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"").replace(/<\!--[\s\S]*?--\>/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(b){var c=b.match(/width:([ \d.]*p[tx])/i)[1],g=b.match(/height:([ \d.]*p[tx])/i)[1],b=b.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+a(c)+'" height="'+a(g)+'" src="'+b+'" />'}).replace(/v:\w+=["']?[^'"]+["']?/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,
"<p><strong>$1</strong></p>").replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"").replace(/<font[^>]*>\s*<\/font>/gi,"").replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoNormal(Table)?))\s*["']?/gi,"");g=g.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(a,c,g,f){a=[];g=0;f=f.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(g=0;g<f.length;g++){var d,e,j=f[g].split(":");if(2==j.length){d=j[0].toLowerCase();e=j[1].toLowerCase();switch(d){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-table-layout-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":/<table/.test(c)||
(a[g]=d.replace(/^mso-|-alt$/g,"")+":"+b(e));continue;case "horiz-align":a[g]="text-align:"+e;continue;case "vert-align":a[g]="vertical-align:"+e;continue;case "font-color":case "mso-foreground":a[g]="color:"+e;continue;case "mso-background":case "mso-highlight":a[g]="background:"+e;continue;case "mso-default-height":a[g]="min-height:"+b(e);continue;case "mso-default-width":a[g]="min-width:"+b(e);continue;case "mso-padding-between-alt":a[g]="border-collapse:separate;border-spacing:"+b(e);continue;
case "text-line-through":if("single"==e||"double"==e)a[g]="text-decoration:line-through";continue;case "mso-zero-height":"yes"==e&&(a[g]="display:none");continue;case "margin":if(!/[1-9]/.test(j[1]))continue}if(!/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/mso\-list/.test(d))a[g]=d+":"+j[1]}}return 0<g?c+' style="'+a.join(";")+'"':c});return g=g.replace(/([ ]+)<\/span>/ig,
function(a,b){return Array(b.length+1).join("&nbsp;")+"</span>"})}return function(a){q=null;v=u=r="";RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig).test(a)&&(a=c(a));return a.replace(/>[ \t\r\n]*</g,"><")}}(),t={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"},q,o={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,
"upper-alpha":/^\(?[A-Z]+\)?$/},s={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},r="",u="",v;e.prototype={rules:null,filter:function(a,c,g){function f(a,c){a.name="element"==a.type?a.tag:t[a.type];if(null==c)return b(a,f,a);if(e&&e[a.name])return g&&(g.flag=1),{type:"fragment",children:[]};if(d&&"element"==a.type)if("fragment"==c.type?d[a.name]:d[a.name]&&d[c.name][a.name]){var j;if(j=d[a.name].$){var i=a.attributes,h={},m;for(m in j)i[m]&&(h[m]=i[m]);a.attributes=h}}else g&&
(g.flag=1),a.type="fragment",a.name=c.name;(e||d)&&b(a,f,a);return a}var d=(c=c||this.rules)&&c.whiteList,e=c&&c.blackList;return f(a,null)},transformInput:function(a,g){function f(a){a=c(a,g);if("ol"==a.tag||"ul"==a.tag)q=1;a=b(a,f,a);if("ol"==a.tag||"ul"==a.tag)q=0,v=u=r="";"text"==a.type&&a.data.replace(/\s/g,"")==j.options.pageBreakTag&&(a.type="element",a.name=a.tag="hr",delete a.data,a.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"},
a.children=[]);"text"==a.type&&!dtd.$notTransContent[a.parent.tag]&&(a.data=a.data.replace(/[\r\t\n]*/g,""));return a}return f(a)},transformOutput:function(a){function c(a){"hr"==a.tag&&"pagebreak"==a.attributes["class"]&&(delete a.tag,a.type="text",a.data=j.options.pageBreakTag,delete a.children);a:switch(a.tag){case "table":!a.attributes.style&&delete a.attributes.style;i&&a.attributes.style&&h(a);break;case "td":case "th":if(/display\s*:\s*none/i.test(a.attributes.style)){a={type:"fragment",children:[]};
break a}i&&!a.children.length&&(a.children[0]={type:"text",data:domUtils.fillChar,parent:a});i&&a.attributes.style&&h(a);break;case "img":a.attributes.anchorname?(a.tag="a",a.attributes={name:a.attributes.anchorname,anchorname:1},a.closed=null):a.attributes.data_ue_src&&(a.attributes.src=a.attributes.data_ue_src,delete a.attributes.data_ue_src);break;case "a":a.attributes.data_ue_src&&(a.attributes.href=a.attributes.data_ue_src,delete a.attributes.data_ue_src)}if("ol"==a.tag||"ul"==a.tag)q=1;a=b(a,
c,a);if("ol"==a.tag||"ul"==a.tag)q=0;return a}return c(a)},toHTML:k,parseHTML:m,word:n};j.serialize=new e(j.options.serialize);UE.serialize=new e({})};UE.plugins.basestyle=function(){var a={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},d=function(a,c){var d=a.selection.getStartElementPath();return utils.findNode(d,c)},c=this,h;for(h in a)(function(a,e){c.commands[a]={execCommand:function(a){var b=new dom.Range(c.document),j="";if(c.currentSelectedArr&&0<c.currentSelectedArr.length){for(var f=0,h;h=c.currentSelectedArr[f++];)if("none"!=h.style.display){b.selectNodeContents(h).select();!j&&(j=d(this,e));if("superscript"==
a||"subscript"==a)(!j||j.tagName.toLowerCase()!=a)&&b.removeInlineStyle(["sub","sup"]);j?b.removeInlineStyle(e):b.applyInlineStyle(e[0])}b.selectNodeContents(c.currentSelectedArr[0]).select()}else{b=c.selection.getRange();j=d(this,e);if(b.collapsed){if(j)a=c.document.createTextNode(""),b.insertNode(a).removeInlineStyle(e),b.setStartBefore(a),domUtils.remove(a);else{j=b.document.createElement(e[0]);if("superscript"==a||"subscript"==a)a=c.document.createTextNode(""),b.insertNode(a).removeInlineStyle(["sub",
"sup"]).setStartBefore(a).collapse(!0);b.insertNode(j).setStart(j,0)}b.collapse(!0)}else{if("superscript"==a||"subscript"==a)(!j||j.tagName.toLowerCase()!=a)&&b.removeInlineStyle(["sub","sup"]);j?b.removeInlineStyle(e):b.applyInlineStyle(e[0])}b.select()}return!0},queryCommandState:function(){return this.highlight?-1:d(this,e)?1:0}}})(h,a[h])};baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){function a(){var a=document.getElementById("edui_fixedlayer");e.setViewportOffset(a,{left:0,top:0})}var d=baidu.editor.browser,c=baidu.editor.dom.domUtils,h=window.$EDITORUI={},b=0,e=baidu.editor.ui.uiUtils={uid:function(a){return a?a.ID$EDITORUI||(a.ID$EDITORUI=++b):++b},hook:function(a,b){var c;a&&a._callbacks?c=a:(c=function(){var b;a&&(b=a.apply(this,arguments));for(var g=c._callbacks,d=g.length;d--;){var e=g[d].apply(this,arguments);void 0===b&&(b=e)}return b},c._callbacks=[]);c._callbacks.push(b);
return c},createElementByHtml:function(a){var b=document.createElement("div");b.innerHTML=a;b=b.firstChild;b.parentNode.removeChild(b);return b},getViewportElement:function(){return d.ie&&d.quirks?document.body:document.documentElement},getClientRect:function(a){for(var b=a.getBoundingClientRect(),d={left:Math.round(b.left),top:Math.round(b.top),height:Math.round(b.bottom-b.top),width:Math.round(b.right-b.left)},f;(f=a.ownerDocument)!==document&&(a=c.getWindow(f).frameElement);)b=a.getBoundingClientRect(),
d.left+=b.left,d.top+=b.top;d.bottom=d.top+d.height;d.right=d.left+d.width;return d},getViewportRect:function(){var a=e.getViewportElement(),b=(window.innerWidth||a.clientWidth)|0,a=(window.innerHeight||a.clientHeight)|0;return{left:0,top:0,height:a,width:b,bottom:a,right:b}},setViewportOffset:function(a,b){var d=e.getFixedLayer();a.parentNode===d?(a.style.left=b.left+"px",a.style.top=b.top+"px"):c.setViewportOffset(a,b)},getEventOffset:function(a){var b=e.getClientRect(a.target||a.srcElement),a=
e.getViewportOffsetByEvent(a);return{left:a.left-b.left,top:a.top-b.top}},getViewportOffsetByEvent:function(a){var b=a.target||a.srcElement,d=c.getWindow(b).frameElement,a={left:a.clientX,top:a.clientY};d&&b.ownerDocument!==document&&(b=e.getClientRect(d),a.left+=b.left,a.top+=b.top);return a},setGlobal:function(a,b){h[a]=b;return'$EDITORUI["'+a+'"]'},unsetGlobal:function(a){delete h[a]},copyAttributes:function(a,b){for(var c=b.attributes,f=c.length;f--;){var e=c[f];"style"!=e.nodeName&&("class"!=
e.nodeName&&(!d.ie||e.specified))&&a.setAttribute(e.nodeName,e.nodeValue)}b.className&&(a.className+=" "+b.className);b.style.cssText&&(a.style.cssText+=";"+b.style.cssText)},removeStyle:function(a,b){if(a.style.removeProperty)a.style.removeProperty(b);else if(a.style.removeAttribute)a.style.removeAttribute(b);else throw"";},contains:function(a,b){return a&&b&&(a===b?!1:a.contains?a.contains(b):a.compareDocumentPosition(b)&16)},startDrag:function(a,b,c){function f(a){b.ondragmove(a.clientX-d,a.clientY-
e);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}var c=c||document,d=a.clientX,e=a.clientY;if(c.addEventListener)c.addEventListener("mousemove",f,!0),c.addEventListener("mouseup",function(){c.removeEventListener("mousemove",f,!0);c.removeEventListener("mouseup",f,!0);b.ondragstop()},!0),a.preventDefault();else{var h=a.srcElement;h.setCapture();var n=function(){h.releaseCapture();h.detachEvent("onmousemove",f);h.detachEvent("onmouseup",n);h.detachEvent("onlosecaptrue",n);b.ondragstop()};
h.attachEvent("onmousemove",f);h.attachEvent("onmouseup",n);h.attachEvent("onlosecaptrue",n);a.returnValue=!1}b.ondragstart()},getFixedLayer:function(){var b=document.getElementById("edui_fixedlayer");null==b&&(b=document.createElement("div"),b.id="edui_fixedlayer",document.body.appendChild(b),d.ie&&8>=d.version?(b.style.position="absolute",c.on(window,"scroll",a),c.on(window,"resize",baidu.editor.utils.defer(a,0,!0)),setTimeout(a)):b.style.position="fixed",b.style.left="0",b.style.top="0",b.style.width=
"0",b.style.height="0");return b},makeUnselectable:function(a){if(d.opera||d.ie&&9>d.version){if(a.unselectable="on",a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)1==a.childNodes[b].nodeType&&e.makeUnselectable(a.childNodes[b])}else void 0!==a.style.MozUserSelect?a.style.MozUserSelect="none":void 0!==a.style.WebkitUserSelect?a.style.WebkitUserSelect="none":void 0!==a.style.KhtmlUserSelect&&(a.style.KhtmlUserSelect="none")}}})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,h=baidu.editor.ui.UIBase=function(){};h.prototype={className:"",uiName:"",initOptions:function(a){for(var c in a)this[c]=a[c];this.id=this.id||"edui"+d.uid()},initUIBase:function(){this._globalKey=a.unhtml(d.setGlobal(this.id,this))},render:function(a){var c=this.renderHtml(),c=d.createElementByHtml(c),h=this.getDom();null!=h?(h.parentNode.replaceChild(c,h),d.copyAttributes(c,h)):("string"==typeof a&&(a=document.getElementById(a)),
a=a||d.getFixedLayer(),a.appendChild(c));this.postRender()},getDom:function(a){return a?document.getElementById(this.id+"_"+a):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(a){var c="edui-"+this.uiName;return a.replace(/##/g,this.id).replace(/%%-/g,this.uiName?c+"-":"").replace(/%%/g,(this.uiName?c:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},
dispose:function(){var a=this.getDom();a&&baidu.editor.dom.domUtils.remove(a);d.unsetGlobal(this.id)}};a.inherits(h,c)})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(a){this.initOptions(a);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(c,d)})();(function(){var a=baidu.editor.utils,d=baidu.editor.dom.domUtils,c=baidu.editor.ui.UIBase,h=baidu.editor.ui.uiUtils,b=baidu.editor.ui.Mask=function(a){this.initOptions(a);this.initUIBase()};b.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var a=this;d.on(window,"resize",function(){setTimeout(function(){a.isHidden()||a._fill()})})},show:function(a){this._fill();this.getDom().style.display="";
this.getDom().style.zIndex=a},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_fill:function(){var a=this.getDom(),b=h.getViewportRect();a.style.width=b.width+"px";a.style.height=b.height+"px"}};a.inherits(b,c)})();(function(){function a(a){for(var b=0;b<i.length;b++){var c=i[b];c.isHidden()||!1!==c.queryAutoHide(a)&&c.hide()}}var d=baidu.editor.utils,c=baidu.editor.ui.uiUtils,h=baidu.editor.dom.domUtils,b=baidu.editor.ui.UIBase,e=baidu.editor.ui.Popup=function(a){this.initOptions(a);this.initPopup()},i=[];e.postHide=a;var g=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];e.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,
initPopup:function(){this.initUIBase();i.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return"string"==typeof this.content?
this.content:this.content.renderHtml()},_UIBase_postRender:b.prototype.postRender,postRender:function(){this.content instanceof b&&this.content.postRender();this.fireEvent("postRenderAfter");this.hide(!0);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var a=this.getDom("content");return c.getClientRect(a)},fitSize:function(){var a=this.getDom("body");a.style.width="";a.style.height="";var b=this.mesureSize();a.style.width=
b.width+"px";a.style.height=b.height+"px";return b},showAnchor:function(a,b){this.showAnchorRect(c.getClientRect(a),b)},showAnchorRect:function(a,b){this._doAutoRender();var d=c.getViewportRect();this._show();var e=this.fitSize(),i,n;b?(i=this.canSideLeft&&a.right+e.width>d.right&&a.left>e.width,d=this.canSideUp&&a.top+e.height>d.bottom&&a.bottom>e.height,n=i?a.left-e.width:a.right,e=d?a.bottom-e.height:a.top):(i=this.canSideLeft&&a.right+e.width>d.right&&a.left>e.width,d=this.canSideUp&&a.top+e.height>
d.bottom&&a.bottom>e.height,n=i?a.right-e.width:a.left,e=d?a.top-e.height:a.bottom);var t=this.getDom();c.setViewportOffset(t,{left:n,top:e});h.removeClasses(t,g);t.className+=" "+g[2*(d?1:0)+(i?1:0)];this.editor&&(t.style.zIndex=1*this.editor.container.style.zIndex+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=t.style.zIndex-1)},showAt:function(a){var b=a.left,a=a.top;this.showAnchorRect({left:b,top:a,right:b,bottom:a,height:0,width:0},!1,!0)},_show:function(){this._hidden&&(this.getDom().style.display=
"",this._hidden=!1,this.fireEvent("show"))},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(a){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,a||this.fireEvent("hide"))},queryAutoHide:function(a){return!a||!c.contains(this.getDom(),a)}};d.inherits(e,b);h.on(document,"mousedown",function(b){a(b.target||b.srcElement)});h.on(window,"scroll",function(){a()})})();(function(){var a=baidu.editor.dom.domUtils,d=baidu.editor.ui.uiUtils,c='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(baidu.editor.browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,Stateful_init:function(){this._Stateful_dGetHtmlTpl=
this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){return this._Stateful_dGetHtmlTpl().replace(/stateful/g,function(){return c})},Stateful_onMouseEnter:function(){if(!this.isDisabled()||this.alwalysHoverable)this.addState("hover"),this.fireEvent("over")},Stateful_onMouseLeave:function(){if(!this.isDisabled()||this.alwalysHoverable)this.removeState("hover"),this.removeState("active"),this.fireEvent("out")},Stateful_onMouseOver:function(a,b){var c=a.relatedTarget;
!d.contains(b,c)&&b!==c&&this.Stateful_onMouseEnter(a,b)},Stateful_onMouseOut:function(a,b){var c=a.relatedTarget;!d.contains(b,c)&&b!==c&&this.Stateful_onMouseLeave(a,b)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(c){return a.hasClass(this.getStateDom(),"edui-state-"+c)},
addState:function(a){this.hasState(a)||(this.getStateDom().className+=" edui-state-"+a)},removeState:function(c){this.hasState(c)&&a.removeClasses(this.getStateDom(),["edui-state-"+c])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(a){!this.isDisabled()&&a?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(a){a?(this.removeState("hover"),this.removeState("checked"),
this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,h=baidu.editor.ui.Button=function(a){this.initOptions(a);this.initButton()};h.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+
(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){this.isDisabled()||this.fireEvent("click")}};a.inherits(h,d);a.extend(h.prototype,c)})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,h=baidu.editor.ui.Stateful,b=baidu.editor.ui.SplitButton=function(a){this.initOptions(a);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();if(null!=this.popup){var a=this.popup;this.popup=null;this.setPopup(a)}},_UIBase_postRender:c.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},
setPopup:function(b){this.popup!==b&&(null!=this.popup&&this.popup.dispose(),b.addListener("show",a.bind(this._onPopupShow,this)),b.addListener("hide",a.bind(this._onPopupHide,this)),b.addListener("postrender",a.bind(function(){b.getDom("body").appendChild(d.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(d.getClientRect(this.getDom()).width-2)+'px"></div>'));b.getDom().className+=" "+this.className},this)),this.popup=b)},_onPopupShow:function(){this.addState("opened")},
_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var a=
d.getClientRect(this.getDom());a.top-=this.popup.SHADOW_RADIUS;a.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(a)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}};a.inherits(b,c);a.extend(b.prototype,h,!0)})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,h=baidu.editor.ui.Toolbar=function(a){this.initOptions(a);this.initToolbar()};h.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(a){this.items.push(a)},getHtmlTpl:function(){for(var a=[],c=0;c<this.items.length;c++)a[c]=this.items[c].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+
a.join("")+"</div>"},postRender:function(){for(var a=this.getDom(),c=0;c<this.items.length;c++)this.items[c].postRender();d.makeUnselectable(a)},_onMouseDown:function(){return!1}};a.inherits(h,c)})();(function(){var a=baidu.editor.utils,d=baidu.editor.dom.domUtils,c=baidu.editor.ui.uiUtils,h=baidu.editor.ui.UIBase,b=baidu.editor.ui.Popup,e=baidu.editor.ui.Stateful,i=baidu.editor.ui.Menu=function(a){this.initOptions(a);this.initMenu()},g={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};i.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||
[];this.initPopup();this.initItems()},initItems:function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];"-"==b?this.items[a]=this.getSeparator():b instanceof j||(this.items[a]=this.createItem(b))}},getSeparator:function(){return g},createItem:function(a){return new j(a)},_Popup_getContentHtmlTpl:b.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var a=[],b=0;b<this.items.length;b++)a[b]=this.items[b].renderHtml();
return'<div class="%%-body">'+a.join("")+"</div>"},_Popup_postRender:b.prototype.postRender,postRender:function(){for(var a=this,b=0;b<this.items.length;b++){var g=this.items[b];g.ownerMenu=this;g.postRender()}d.on(this.getDom(),"mouseover",function(b){var b=b||event,b=b.relatedTarget||b.fromElement,g=a.getDom();!c.contains(g,b)&&g!==b&&a.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(a){if(a){if(c.contains(this.getDom(),a))return!1;for(var b=0;b<this.items.length;b++)if(!1===
this.items[b].queryAutoHide(a))return!1}},clearItems:function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];clearTimeout(b._showingTimer);clearTimeout(b._closingTimer);b.subMenu&&b.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&d.remove(this.getDom());this.clearItems()},dispose:function(){this.destroy()}};a.inherits(i,b);var j=baidu.editor.ui.MenuItem=function(a){this.initOptions(a);this.initUIBase();this.Stateful_init();this.subMenu&&!(this.subMenu instanceof i)&&
(this.subMenu=new i(this.subMenu))};j.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var a=this;this.addListener("over",function(){a.ownerMenu.fireEvent("submenuover",a);a.subMenu&&a.delayShowSubMenu()});this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),
this.addListener("out",function(){a.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(a._closingTimer);a._closingTimer=null;a.addState("opened")}),this.ownerMenu.addListener("hide",function(){a.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(b,c){c!==a&&a.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(b){return b&&c.contains(a.getDom(),b)?!1:this._bakQueryAutoHide(b)});this.getDom().style.tabIndex=
"-1";c.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var a=this;a.isDisabled()||(a.addState("opened"),clearTimeout(a._showingTimer),clearTimeout(a._closingTimer),a._closingTimer=null,a._showingTimer=setTimeout(function(){a.showSubMenu()},250))},delayHideSubMenu:function(){var a=this;a.isDisabled()||(a.removeState("opened"),clearTimeout(a._showingTimer),a._closingTimer||(a._closingTimer=setTimeout(function(){a.hasState("opened")||a.hideSubMenu();a._closingTimer=
null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(a){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(a)},_onClick:function(a,c){this.hasState("disabled")||!1!==this.fireEvent("click",a,c)&&(this.subMenu?this.showSubMenu():b.postHide())},showSubMenu:function(){var a=c.getClientRect(this.getDom());
a.right-=5;a.left+=2;a.width-=7;a.top-=4;a.bottom+=4;a.height+=8;this.subMenu.showAnchorRect(a,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}};a.inherits(j,h);a.extend(j.prototype,e,!0)})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.uiUtils,c=baidu.editor.ui.Menu,h=baidu.editor.ui.SplitButton,b=baidu.editor.ui.Combox=function(a){this.initOptions(a);this.initCombox()};b.prototype={uiName:"combox",initCombox:function(){var a=this;this.items=this.items||[];for(var b=0;b<this.items.length;b++){var g=this.items[b];g.uiName="listitem";g.index=b;g.onclick=function(){a.selectByIndex(this.index)}}this.popup=new c({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},
_SplitButton_postRender:h.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var a=d.getClientRect(this.getDom());a.top+=1;a.bottom-=1;a.height-=2;this.popup.showAnchorRect(a)},getValue:function(){return this.value},setValue:function(a){var b=this.indexByValue(a);-1!=b?(this.selectedIndex=b,this.setLabel(this.items[b].label),this.value=this.items[b].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(a)),
this.value=a)},setLabel:function(a){this.label=this.getDom("button_body").innerHTML=a},getLabelForUnknowValue:function(a){return a},indexByValue:function(a){for(var b=0;b<this.items.length;b++)if(a==this.items[b].value)return b;return-1},getItem:function(a){return this.items[a]},selectByIndex:function(a){a<this.items.length&&!1!==this.fireEvent("select",a)&&(this.selectedIndex=a,this.value=this.items[a].value,this.setLabel(this.items[a].label))}};a.inherits(b,h)})();(function(){var a=baidu.editor.utils,d=baidu.editor.dom.domUtils,c=baidu.editor.ui.uiUtils,h=baidu.editor.ui.Mask,b=baidu.editor.ui.UIBase,e=baidu.editor.ui.Button,i=baidu.editor.ui.Dialog=function(a){this.initOptions(a);this.initDialog()},g,j;i.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var a=this;this.initUIBase();this.modalMask=g||(g=new h({className:"edui-dialog-modalmask"}));this.dragMask=j||(j=new h({className:"edui-dialog-dragmask"}));this.closeButton=new e({className:"edui-dialog-closebutton",
title:"\u5173\u95ed\u5bf9\u8bdd\u6846",onclick:function(){a.close(!1)}});if(this.buttons)for(var b=0;b<this.buttons.length;b++)this.buttons[b]instanceof e||(this.buttons[b]=new e(this.buttons[b]))},fitSize:function(){var a=this.getDom("body"),b=this.mesureSize();a.style.width=b.width+"px";a.style.height=b.height+"px";return b},safeSetOffset:function(a){var b=this.getDom(),g=c.getViewportRect(),d=c.getClientRect(b),e=a.left;e+d.width>g.right&&(e=g.right-d.width);a=a.top;a+d.height>g.bottom&&(a=g.bottom-
d.height);b.style.left=Math.max(e,0)+"px";b.style.top=Math.max(a,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var a=c.getViewportRect(),b=this.fitSize();this.getDom("titlebar");var g=a.width/2-b.width/2,a=0.4*(a.height-b.height);0>a&&(a=0);b=this.getDom();this.safeSetOffset({left:Math.max(g|0,0),top:Math.max(a|0,0)});d.hasClass(b,"edui-state-centered")||(b.className+=" edui-state-centered");this._show()},getContentHtml:function(){var a="";"string"==typeof this.content?a=this.content:
this.iframeUrl&&(a='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>');return a},getHtmlTpl:function(){var a="";if(this.buttons){for(var a=[],b=0;b<this.buttons.length;b++)a[b]=this.buttons[b].renderHtml();a='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+a.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+
(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+a+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide());this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var a=this;this.addListener("show",function(){a.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){a.modalMask.hide()});
if(this.buttons)for(var b=0;b<this.buttons.length;b++)this.buttons[b].postRender();d.on(window,"resize",function(){setTimeout(function(){a.isHidden()||a.safeSetOffset(c.getClientRect(a.getDom()))})});this._hide()},mesureSize:function(){var a=this.getDom("body"),b=c.getClientRect(this.getDom("content")).width;a.style.width=b;return c.getClientRect(a)},_onTitlebarMouseDown:function(a){if(this.draggable){var b;c.getViewportRect();var g=this;c.startDrag(a,{ondragstart:function(){b=c.getClientRect(g.getDom());
g.dragMask.show(g.getDom().style.zIndex-1)},ondragmove:function(a,c){g.safeSetOffset({left:b.left+a,top:b.top+c})},ondragstop:function(){d.removeClasses(g.getDom(),["edui-state-centered"]);g.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=
this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){this.autoReset&&this.reset();this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(a){}},_onCloseButtonClick:function(){this.close(!1)},close:function(a){!1!==this.fireEvent("close",a)&&this._hide()}};a.inherits(i,b)})();(function(){var a=baidu.editor.utils,d=baidu.editor.ui.Menu,c=baidu.editor.ui.SplitButton,h=baidu.editor.ui.MenuButton=function(a){this.initOptions(a);this.initMenuButton()};h.prototype={initMenuButton:function(){var a=this;this.uiName="menubutton";this.popup=new d({items:a.items,className:a.className,editor:a.editor});this.popup.addListener("show",function(){for(var c=0;c<this.items.length;c++)this.items[c].removeState("checked"),this.items[c].value==a._value&&(this.items[c].addState("checked"),
this.value=a._value)});this.initSplitButton()},setValue:function(a){this._value=a}};a.inherits(h,c)})();(function(){var a=baidu.editor.browser.ie,d=baidu.editor.utils,c=baidu.editor.ui,h=c.Dialog;c.Dialog=function(a){var b=new h(a);b.addListener("hide",function(){if(b.editor){var a=b.editor;try{a.focus()}catch(c){}}});return b};var b,e,i="Undo Redo FormatMatch Bold Italic Underline StrikeThrough Subscript Superscript Source Indent Outdent BlockQuote PastePlain PageBreak SelectAll Print Preview Horizontal RemoveFormat Time Date Unlink InsertParagraphBeforeTable InsertRow InsertCol MergeRight MergeDown DeleteRow DeleteCol SplittoRows SplittoCols SplittoCells MergeCells DeleteTable".split(" ");
for(b=i.length;b--;)e=i[b],c[e]=function(a){return function(b,d){var d=d||b.options.labelMap[a.toLowerCase()]||"",e=new c.Button({className:"edui-for-"+a.toLowerCase(),title:d,onclick:function(){b.execCommand(a)},showText:!1});b.addListener("selectionchange",function(c,d,f){c=b.queryCommandState(a.toLowerCase());-1==c?(e.setDisabled(!0),e.setChecked(!1)):f||(e.setDisabled(!1),e.setChecked(c))});return e}}(e);c.SnapScreen=function(b,d){var d=d||b.options.labelMap.snapscreen||"",f=new c.Button({className:"edui-for-snapscreen",
title:d,onclick:function(){b.execCommand("SnapScreen")}});if(a){var e=b.options.iframeUrlMap.snapscreen,e=b.ui.mapUrl(e),d=d||b.options.labelMap.snapscreen||"",h=new c.Dialog({iframeUrl:e,autoReset:!0,draggable:!0,editor:b,className:"edui-for-snapscreen",title:d,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?
this.onok():this.oncancel()}});h.render();b.snapscreenInstall=h}b.addListener("selectionchange",function(){var a=b.queryCommandState("snapscreen");f.setDisabled(-1==a)});return f};c.ClearDoc=function(a,b){var b=b||a.options.labelMap.cleardoc||"",d=new c.Button({className:"edui-for-cleardoc",title:b,onclick:function(){confirm("\u786e\u5b9a\u6e05\u7a7a\u6587\u6863\u5417\uff1f")&&a.execCommand("cleardoc")}});a.addListener("selectionchange",function(){var b=a.queryCommandState("cleardoc");d.setDisabled(-1==
b)});return d};c.Justify=function(a,b,d){var b=(b||"left").toLowerCase(),d=d||a.options.labelMap["justify"+b.toLowerCase()]||"",e=new c.Button({className:"edui-for-justify"+b.toLowerCase(),title:d,onclick:function(){a.execCommand("Justify",b)}});a.addListener("selectionchange",function(c,d,f){c=a.queryCommandState("Justify");e.setDisabled(-1==c);c=a.queryCommandValue("Justify");e.setChecked(c==b&&!f)});return e};c.JustifyLeft=function(a,b){return c.Justify(a,"left",b)};c.JustifyCenter=function(a,
b){return c.Justify(a,"center",b)};c.JustifyRight=function(a,b){return c.Justify(a,"right",b)};c.JustifyJustify=function(a,b){return c.Justify(a,"justify",b)};c.ImageFloat=function(a,b,d){var b=(b||"none").toLowerCase(),d=d||a.options.labelMap["image"+b.toLowerCase()]||"",e=new c.Button({className:"edui-for-image"+b.toLowerCase(),title:d,onclick:function(){a.execCommand("imagefloat",b)}});a.addListener("selectionchange",function(){var c=a.queryCommandState("imagefloat");e.setDisabled(-1==c);c=a.queryCommandValue("imagefloat");
e.setChecked(c==b)});return e};c.ImageNone=function(a,b){return c.ImageFloat(a,b)};c.ImageLeft=function(a,b){return c.ImageFloat(a,"left",b)};c.ImageRight=function(a,b){return c.ImageFloat(a,"right",b)};c.ImageCenter=function(a,b){return c.ImageFloat(a,"center",b)};c.Directionality=function(a,b,d){var b=(b||"left").toLowerCase(),d=d||a.options.labelMap["directionality"+b.toLowerCase()]||"",e=new c.Button({className:"edui-for-directionality"+b.toLowerCase(),title:d,onclick:function(){a.execCommand("directionality",
b)},type:b});a.addListener("selectionchange",function(b,c,d){b=a.queryCommandState("directionality");e.setDisabled(-1==b);b=a.queryCommandValue("directionality");e.setChecked(b==e.type&&!d)});return e};c.DirectionalityLtr=function(a,b){return new c.Directionality(a,"ltr",b)};c.DirectionalityRtl=function(a,b){return new c.Directionality(a,"rtl",b)};i=["BackColor","ForeColor"];for(b=i.length;b--;)e=i[b],c[e]=function(a){return function(b,d){var d=d||b.options.labelMap[a.toLowerCase()]||"",e=new c.ColorButton({className:"edui-for-"+
a.toLowerCase(),color:"default",title:d,editor:b,onpickcolor:function(c,d){b.execCommand(a,d)},onpicknocolor:function(){b.execCommand(a,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){b.execCommand(a,this.color)}});b.addListener("selectionchange",function(){-1==b.queryCommandState(a)?e.setDisabled(!0):e.setDisabled(!1)});return e}}(e);i=["SearchReplace","Help","Spechars"];for(b=i.length;b--;)e=i[b],c[e]=function(a){a=a.toLowerCase();return function(b,d,e){var d=
d||b.options.iframeUrlMap[a.toLowerCase()]||"about:blank",d=b.ui.mapUrl(d),e=e||b.options.labelMap[a.toLowerCase()]||"",h=new c.Dialog({iframeUrl:d,autoReset:!0,draggable:!0,editor:b,className:"edui-for-"+a,title:e,onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render();var i=new c.Button({className:"edui-for-"+a,title:e,onclick:function(){h.open()}});b.addListener("selectionchange",function(){-1==b.queryCommandState(a)?i.setDisabled(!0):i.setDisabled(!1)});
return i}}(e);i="Attachment Anchor Link InsertImage Map GMap InsertVideo TableSuper HighlightCode InsertFrame EditTd".split(" ");for(b=i.length;b--;)e=i[b],c[e]=function(a){a=a.toLowerCase();return function(b,d,e){var d=d||b.options.iframeUrlMap[a.toLowerCase()]||"about:blank",d=b.ui.mapUrl(d),e=e||b.options.labelMap[a.toLowerCase()]||"",h=new c.Dialog({iframeUrl:d,autoReset:!0,draggable:!0,editor:b,className:"edui-for-"+a,title:e,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},
{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render();var i=new c.Button({className:"edui-for-"+a,title:e,onclick:function(){h.open()}});b.addListener("selectionchange",function(){var c=b.queryCommandState(a);-1==c?i.setDisabled(!0):(i.setChecked(c),i.setDisabled(!1))});return i}}(e);c.WordImage=function(a){var b=new c.Button({className:"edui-for-wordimage",
title:"\u56fe\u7247\u8f6c\u5b58",onclick:function(){a.execCommand("wordimage","word_img");a.ui._dialogs.wordImageDialog.open()}});a.addListener("selectionchange",function(){var c=a.queryCommandState("wordimage","word_img");-1==c?b.setDisabled(!0):(b.setDisabled(!1),b.setChecked(c))});return b};c.FontFamily=function(a,b,e){for(var b=b||a.options.listMap.fontfamily||[],e=e||a.options.labelMap.fontfamily||"",h=[],i=0;i<b.length;i++){var k=b[i],n=a.options.fontMap[k],t='"'+k+'"',q=RegExp(k,"i");n&&(t=
'"'+n.join('","')+'"',q=RegExp("(?:\\|)"+n.join("|")+"(?:\\|)","i"));h.push({label:k,value:t,regex:q,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+d.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}var o=new c.Combox({editor:a,items:h,onselect:function(b,c){a.execCommand("FontFamily",this.items[c].value)},onbuttonclick:function(){this.showPopup()},title:e,initValue:a.options.ComboxInitial.FONT_FAMILY,className:"edui-for-fontfamily",indexByValue:function(a){if(a){a=
"|"+a.replace(/,/g,"|").replace(/"/g,"")+"|";a.replace(/\s*|\s*/g,"|");for(var b=0;b<this.items.length;b++)if(this.items[b].regex.test(a))return b}return-1}});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("FontFamily")?o.setDisabled(!0):(o.setDisabled(!1),(b=a.queryCommandValue("FontFamily"))&&(b=b.replace(/['"]/g,"").split(",")[0]),o.setValue(b)))});return o};c.FontSize=function(a,b,d){for(var b=b||a.options.listMap.fontsize||[],d=d||a.options.labelMap.fontsize||"",
e=[],h=0;h<b.length;h++){var i=b[h]+"px";e.push({label:i,value:i,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var n=new c.Combox({editor:a,items:e,title:d,initValue:a.options.ComboxInitial.FONT_SIZE,onselect:function(b,c){a.execCommand("FontSize",this.items[c].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("FontSize")?
n.setDisabled(!0):(n.setDisabled(!1),n.setValue(a.queryCommandValue("FontSize"))))});return n};c.Paragraph=function(a,b,d){for(var b=b||a.options.listMap.paragraph||[],d=d||a.options.labelMap.paragraph||"",e=[],h=0;h<b.length;h++){var i=b[h].split(":");e.push({label:i[1],value:i[0],renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var n=new c.Combox({editor:a,items:e,title:d,initValue:a.options.ComboxInitial.PARAGRAPH,
className:"edui-for-paragraph",onselect:function(b,c){a.execCommand("Paragraph",this.items[c].value)},onbuttonclick:function(){this.showPopup()}});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("Paragraph")?n.setDisabled(!0):(n.setDisabled(!1),b=a.queryCommandValue("Paragraph"),-1!=n.indexByValue(b)?n.setValue(b):n.setValue(n.initValue)))});return n};c.CustomStyle=function(a,b,d){for(var b=b||a.options.listMap.customstyle||[],d=d||a.options.labelMap.customstyle||"",e=
0,h=[],i;i=b[e++];)(function(a){h.push({label:a.label,value:a,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+a.tag+" "+(a.className?' class="'+a.className+'"':"")+(a.style?' style="'+a.style+'"':"")+">"+a.label+"</"+a.tag+"></div>"}})})(i);var n=new c.Combox({editor:a,items:h,title:d,initValue:a.options.ComboxInitial.CUSTOMSTYLE,className:"edui-for-customstyle",onselect:function(b,c){a.execCommand("customstyle",this.items[c].value)},onbuttonclick:function(){this.showPopup()},
indexByValue:function(a){for(var b=0,c;c=this.items[b++];)if(c.label==a)return b-1;return-1}});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("customstyle")?n.setDisabled(!0):(n.setDisabled(!1),b=a.queryCommandValue("customstyle"),-1!=n.indexByValue(b)?n.setValue(b):n.setValue(n.initValue)))});return n};c.InsertTable=function(a,b,d){var b=b||a.options.iframeUrlMap.inserttable||"about:blank",b=a.ui.mapUrl(b),d=d||a.options.labelMap.inserttable||"",e=new c.Dialog({iframeUrl:b,
autoReset:!0,draggable:!0,editor:a,className:"edui-for-inserttable",title:d,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){e.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){e.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});e.render();a.tableDialog=e;var h=new c.TableButton({editor:a,title:d,className:"edui-for-inserttable",onpicktable:function(b,c,d){a.execCommand("InsertTable",
{numRows:d,numCols:c})},onmore:function(){e.open()},onbuttonclick:function(){e.open()}});a.addListener("selectionchange",function(){-1==a.queryCommandState("inserttable")?h.setDisabled(!0):h.setDisabled(!1)});return h};c.AutoTypeSet=function(a,b,d){var d=d||a.options.labelMap.autotypeset||"",e=new c.AutoTypeSetButton({editor:a,title:d,className:"edui-for-autotypeset",onbuttonclick:function(){a.execCommand("autotypeset")}});a.addListener("selectionchange",function(){e.setDisabled(-1==a.queryCommandState("autotypeset"))});
return e};c.LineHeight=function(a,b){for(var d=0,e,h=[];e=a.options.listMap.lineheight[d++];)h.push({label:"1"==e?"\u9ed8\u8ba4":e,value:e,onclick:function(){a.execCommand("lineheight",this.value)}});var i=new c.MenuButton({editor:a,className:"edui-for-lineheight",title:b||a.options.labelMap.lineheight||"",items:h,onbuttonclick:function(){var b=a.queryCommandValue("LineHeight")||this.value;a.execCommand("LineHeight",b)}});a.addListener("selectionchange",function(){var b=a.queryCommandState("LineHeight");
if(-1==b)i.setDisabled(!0);else{i.setDisabled(!1);var c=a.queryCommandValue("LineHeight");c&&i.setValue((c+"").replace(/cm/,""));i.setChecked(b)}});return i};c.RowSpacingTop=function(a,b){for(var d=0,e,h=[];e=a.options.listMap.rowspacing[d++];)h.push({label:e,value:e,onclick:function(){a.execCommand("rowspacing",this.value,"top")}});var i=new c.MenuButton({editor:a,className:"edui-for-rowspacingtop",title:b||a.options.labelMap.rowspacingtop||"\u6bb5\u524d\u95f4\u8ddd",items:h,onbuttonclick:function(){var b=
a.queryCommandValue("rowspacing","top")||this.value;a.execCommand("rowspacing",b,"top")}});a.addListener("selectionchange",function(){var b=a.queryCommandState("rowspacing","top");if(-1==b)i.setDisabled(!0);else{i.setDisabled(!1);var c=a.queryCommandValue("rowspacing","top");c&&i.setValue((c+"").replace(/%/,""));i.setChecked(b)}});return i};c.RowSpacingBottom=function(a,b){for(var d=0,e,h=[];e=a.options.listMap.rowspacing[d++];)h.push({label:e,value:e,onclick:function(){a.execCommand("rowspacing",
this.value,"bottom")}});var i=new c.MenuButton({editor:a,className:"edui-for-rowspacingbottom",title:b||a.options.labelMap.rowspacingbottom||"\u6bb5\u540e\u95f4\u8ddd",items:h,onbuttonclick:function(){var b=a.queryCommandValue("rowspacing","bottom")||this.value;a.execCommand("rowspacing",b,"bottom")}});a.addListener("selectionchange",function(){var b=a.queryCommandState("rowspacing","bottom");if(-1==b)i.setDisabled(!0);else{i.setDisabled(!1);var c=a.queryCommandValue("rowspacing","bottom");c&&i.setValue((c+
"").replace(/%/,""));i.setChecked(b)}});return i};c.InsertOrderedList=function(a,b){var b=b||a.options.labelMap.insertorderedlist||"",d=function(){a.execCommand("InsertOrderedList",this.value)},e=new c.MenuButton({editor:a,className:"edui-for-insertorderedlist",title:b,items:[{label:"1,2,3 ...",value:"decimal",onclick:d},{label:"a,b,c ...",value:"lower-alpha",onclick:d},{label:"i,ii,iii ...",value:"lower-roman",onclick:d},{label:"A,B,C ...",value:"upper-alpha",onclick:d},{label:"I,II,III ...",value:"upper-roman",
onclick:d}],onbuttonclick:function(){var b=a.queryCommandValue("InsertOrderedList")||this.value;a.execCommand("InsertOrderedList",b)}});a.addListener("selectionchange",function(){var b=a.queryCommandState("InsertOrderedList");if(-1==b)e.setDisabled(!0);else{e.setDisabled(!1);var c=a.queryCommandValue("InsertOrderedList");e.setValue(c);e.setChecked(b)}});return e};c.InsertUnorderedList=function(a,b){var b=b||a.options.labelMap.insertunorderedlist||"",d=function(){a.execCommand("InsertUnorderedList",
this.value)},e=new c.MenuButton({editor:a,className:"edui-for-insertunorderedlist",title:b,items:[{label:"\u25cb \u5c0f\u5706\u5708",value:"circle",onclick:d},{label:"\u25cf \u5c0f\u5706\u70b9",value:"disc",onclick:d},{label:"\u25a0 \u5c0f\u65b9\u5757",value:"square",onclick:d}],onbuttonclick:function(){var b=a.queryCommandValue("InsertUnorderedList")||this.value;a.execCommand("InsertUnorderedList",b)}});a.addListener("selectionchange",function(){var b=a.queryCommandState("InsertUnorderedList");if(-1==
b)e.setDisabled(!0);else{e.setDisabled(!1);var c=a.queryCommandValue("InsertUnorderedList");e.setValue(c);e.setChecked(b)}});return e};c.FullScreen=function(a,b){var b=b||a.options.labelMap.fullscreen||"",d=new c.Button({className:"edui-for-fullscreen",title:b,onclick:function(){a.ui&&a.ui.setFullScreen(!a.ui.isFullScreen());this.setChecked(a.ui.isFullScreen())}});a.addListener("selectionchange",function(){var b=a.queryCommandState("fullscreen");d.setDisabled(-1==b);d.setChecked(a.ui.isFullScreen())});
return d};c.Emotion=function(a,b,d){var d=d||a.options.labelMap.emotion||"",b=b||a.options.iframeUrlMap.emotion||"about:blank",b=a.ui.mapUrl(b),e=new c.MultiMenuPop({title:d,editor:a,className:"edui-for-emotion",iframeUrl:b});a.addListener("selectionchange",function(){-1==a.queryCommandState("emotion")?e.setDisabled(!0):e.setDisabled(!1)});return e}})();(function(){function a(a){this.initOptions(a);this.initEditorUI()}var d=baidu.editor.utils,c=baidu.editor.ui.uiUtils,h=baidu.editor.ui.UIBase;a.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var a=this.editor,c=a.options.iframeUrlMap;a.addListener("ready",function(){baidu.editor.dom.domUtils.on(a.window,"scroll",function(){baidu.editor.ui.Popup.postHide()});a.options.elementPathEnabled&&(a.ui.getDom("elementpath").innerHTML=
'<div class="edui-editor-breadcrumb">path:</div>');a.options.wordCount&&(a.ui.getDom("wordcount").innerHTML="\u5b57\u6570\u7edf\u8ba1");a.selection.isFocus()&&a.fireEvent("selectionchange",!1,!0)});a.addListener("mousedown",function(a,b){baidu.editor.ui.Popup.postHide(b.target||b.srcElement)});a.addListener("contextmenu",function(){baidu.editor.ui.Popup.postHide()});var d=this;a.addListener("selectionchange",function(){a.selection.isFocus()&&(d._updateElementPath(),d._wordCount())});a.addListener("sourcemodechanged",
function(c,e){a.options.elementPathEnabled&&(e?d.disableElementPath():d.enableElementPath());a.options.wordCount&&(e?d.disableWordCount():d.enableWordCount())});var g=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.link):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-link",title:"\u8d85\u94fe\u63a5",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){g.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){g.close(!1)}}],onok:function(){},
oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});g.render();var h=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.insertimage):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertimage",title:"\u56fe\u7247",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?
this.onok():this.oncancel()}});h.render();var f=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.anchor):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-anchor",title:"\u951a\u70b9",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){f.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){f.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});f.render();var m=new baidu.editor.ui.Dialog({iframeUrl:c?
a.ui.mapUrl(c.insertvideo):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertvideo",title:"\u89c6\u9891",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){m.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){m.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});m.render();var l=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.wordimage):"",autoReset:!0,draggable:!0,
editor:a,className:"edui-for-wordimage",title:"\u56fe\u7247\u8f6c\u5b58",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){l.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});l.render();d._dialogs.wordImageDialog=l;var k=new baidu.editor.ui.Dialog({iframeUrl:c?d.mapUrl(c.edittd):"about:blank",autoReset:!0,draggable:!0,editor:a,
className:"edui-for-edittd",title:"\u5355\u5143\u683c",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){k.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){k.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});k.render();d._dialogs.tdDialog=k;var n=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.map):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-map",title:"\u5730\u56fe",
buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){n.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){n.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});n.render();var t=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.gmap):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-gmap",title:"Google\u5730\u56fe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",
onclick:function(){t.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){t.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});t.render();var q=new baidu.editor.ui.Popup({editor:a,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();g.open()},_onImgEditButtonClick:function(){this.hide();var c=a.selection.getRange().getClosedNode();(c=baidu.editor.dom.domUtils.findParentByTagName(c,
"img",!0))&&-1!=c.className.indexOf("edui-faked-video")?m.open():c&&-1!=c.src.indexOf("http://api.map.baidu.com")?n.open():c&&-1!=c.src.indexOf("http://maps.google.com/maps/api/staticmap")?t.open():c&&c.getAttribute("anchorname")?f.open():c&&c.getAttribute("word_img")?(a.word_img=[c.getAttribute("word_img")],a.ui._dialogs.wordImageDialog.open()):h.open()},_getImg:function(){var c=a.selection.getRange().getClosedNode();return c&&("img"==c.nodeName||"IMG"==c.nodeName)?c:null},_onImgSetFloat:function(c){this._getImg()&&
(a.execCommand("imagefloat",c),(c=this._getImg())&&this.showAnchor(c))},_setIframeAlign:function(a){var b=q.anchorEl,c=b.cloneNode(!0);switch(a){case -2:c.setAttribute("align","");break;case -1:c.setAttribute("align","left");break;case 1:c.setAttribute("align","right");break;case 2:c.setAttribute("align","middle")}b.parentNode.insertBefore(c,b);baidu.editor.dom.domUtils.remove(b);q.anchorEl=c;q.showAnchor(q.anchorEl)},_updateIframe:function(){a._iframe=q.anchorEl;o.open();q.hide()},_onRemoveButtonClick:function(){var c=
a.selection.getRange().getClosedNode();(c=baidu.editor.dom.domUtils.findParentByTagName(c,"img",!0))&&c.getAttribute("anchorname")?a.execCommand("anchor"):a.execCommand("unlink");this.hide()},queryAutoHide:function(c){return c&&c.ownerDocument==a.document&&("img"==c.tagName.toLowerCase()||baidu.editor.dom.domUtils.findParentByTagName(c,"a",!0))?c!==q.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,c)}});q.render();var o=new baidu.editor.ui.Dialog({iframeUrl:c?a.ui.mapUrl(c.insertframe):
"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertframe",title:"\u63d2\u5165iframe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){o.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){o.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});o.render();a.addListener("mouseover",function(c,d){var d=d||window.event,e=d.target||d.srcElement;if(/iframe/ig.test(e.tagName)&&
a.options.imagePopup){var g=q.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._setIframeAlign(-2) class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">\u5de6\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">\u53f3\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._updateIframe( this);" class="edui-clickable">\u4fee\u6539</span></nobr>');
g?(q.getDom("content").innerHTML=g,q.anchorEl=e,q.showAnchor(q.anchorEl)):q.hide()}});a.addListener("selectionchange",function(c,d){if(d){var e="",g=a.selection.getRange().getClosedNode();null!=g&&"img"==g.tagName.toLowerCase()&&(g.getAttribute("anchorname")?e+=q.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable">\u4fee\u6539</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable">\u5220\u9664</span></nobr>'):a.options.imagePopup&&
(e+=q.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgSetFloat("none") class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">\u5c45\u5de6</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">\u5c45\u53f3</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable">\u4fee\u6539</span></nobr>')));
var f;f=a.selection.getRange().collapsed?a.queryCommandValue("link"):a.selection.getStart();f=baidu.editor.dom.domUtils.findParentByTagName(f,"a",!0);var h;if(null!=f&&null!=(h=f.getAttribute("data_ue_src")||f.getAttribute("href",2))){var i=h;30<h.length&&(i=h.substring(0,20)+"...");e&&(e+='<div style="height:5px;"></div>');e+=q.formatHtml('<nobr>\u94fe\u63a5: <a target="_blank" href="'+h+'" title="'+h+'" >'+i+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);">\u4fee\u6539</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> \u6e05\u9664</span></nobr>');
q.showAnchor(f)}e?(q.getDom("content").innerHTML=e,q.anchorEl=g||f,q.showAnchor(q.anchorEl)):q.hide()}})},_initToolbars:function(){for(var a=this.editor,c=this.toolbars||[],d=[],g=0;g<c.length;g++){for(var h=c[g],f=new baidu.editor.ui.Toolbar,m=0;m<h.length;m++){var l=h[m],k=null;if("string"==typeof l){if("|"==l&&(l="Separator"),baidu.editor.ui[l]&&(k=new baidu.editor.ui[l](a)),"FullScreen"==l){d&&d[0]?d[0].items.splice(0,0,k):f.items.splice(0,0,k);continue}}else k=l;k&&f.add(k)}d[g]=f}this.toolbars=
d},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div><div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">\u70b9\u6b64\u4e0a\u4f20</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td></tr></table></div></div>'},
showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){for(var a=[],c=0;c<this.toolbars.length;c++)a.push(this.toolbars[c].renderHtml());return a.join("")},setFullScreen:function(a){if(this._fullscreen!=a){this._fullscreen=a;this.editor.fireEvent("beforefullscreenchange",a);var c=this.editor;a?(domUtils.addClassName(document.body,"js-ueditor-fullscreen"),domUtils.addClassName(this.editor.document.documentElement,
"js-in-ueditor-fullscreen"),this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.bakAutoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakAutoHeight&&this.editor.disableAutoHeight(),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,
this._updateFullScreen()):(domUtils.delClassName(document.body,"js-ueditor-fullscreen"),domUtils.delClassName(this.editor.document.documentElement,"js-in-ueditor-fullscreen"),this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&this.editor.enableAutoHeight(null,null,!0),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,window.scrollTo(0,this._bakScrollTop));setTimeout(function(){try{c.focus()}catch(a){}},
10);this.editor.fireEvent("fullscreenchanged",a);this.triggerLayout()}},_wordCount:function(){var a=this.getDom("wordcount");this.editor.options.wordCount?a.innerHTML=this.editor.queryCommandValue("wordcount"):a.style.display="none"},disableWordCount:function(){var a=this.getDom("wordcount");a.innerHTML="";a.style.display="none";this.wordcount=!1},enableWordCount:function(){this.getDom("wordcount").style.display="";this.wordcount=!0;this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var a=
c.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px;z-index:"+(1*this.getDom().style.zIndex+100);c.setViewportOffset(this.getDom(),{left:0,top:0});this.editor.setHeight(a.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight);browser.ie&&7>browser.version||(this.getDom().style.position="fixed",this.getDom().style.top=0,this.getDom().style.left=0)}},_updateElementPath:function(){var a=this.getDom("elementpath"),
c;if(this.elementPathEnabled&&(c=this.editor.queryCommandValue("elementpath"))){for(var d=[],g=0,h;h=c[g];g++)d[g]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+g+'&quot;);">'+h+"</span>");a.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+d.join(" &gt; ")+"</div>"}else a.style.display="none"},disableElementPath:function(){var a=this.getDom("elementpath");a.innerHTML="";a.style.display="none";this.elementPathEnabled=
!1},enableElementPath:function(){this.getDom("elementpath").style.display="";this.elementPathEnabled=!0;this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){h.prototype.postRender.call(this);for(var a=0;a<this.toolbars.length;a++)this.toolbars[a].postRender();var c=this,d,g=baidu.editor.dom.domUtils,j=function(){clearTimeout(d);d=setTimeout(function(){c._updateFullScreen()})};g.on(window,"resize",j);c.addListener("destroy",function(){g.un(window,"resize",
j);clearTimeout(d)})},showToolbarMsg:function(a,c){this.getDom("toolbarmsg_label").innerHTML=a;this.getDom("toolbarmsg").style.display="";c||(this.getDom("upload_dialog").style.display="none")},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(a){return(a||"").replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var a=this.getDom();a.style.zoom="1"==a.style.zoom?"100%":"1"}};d.inherits(a,baidu.editor.ui.UIBase);baidu.editor.ui.Editor=
function(b){var c=new baidu.editor.Editor(b);c.options.editor=c;new a(c.options);var d=c.render;c.render=function(a){if(a&&(a.constructor===String&&(a=document.getElementById(a)),a&&a.getAttribute("name")&&(c.options.textarea=a.getAttribute("name")),a&&/script|textarea/ig.test(a.tagName))){var b=document.createElement("div");a.parentNode.insertBefore(b,a);c.options.initialContent=a.value||a.innerHTML;a.id&&(b.id=a.id);a.className&&(b.className=a.className);a.style.cssText&&(b.style.cssText=a.style.cssText);
a.parentNode.removeChild(a);a=b;a.innerHTML=""}c.ui.render(a);a=c.ui.getDom("iframeholder");c.container=c.ui.getDom();c.container.style.zIndex=c.options.zIndex;d.call(c,a)};return c}})();
